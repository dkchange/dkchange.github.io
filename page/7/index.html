<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"dkchange.github.io","root":"/","scheme":"Muse","version":"8.0.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜尋...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="蛋粒個人網誌">
<meta property="og:url" content="http:&#x2F;&#x2F;dkchange.github.io&#x2F;page&#x2F;7&#x2F;index.html">
<meta property="og:site_name" content="蛋粒個人網誌">
<meta property="og:locale" content="zh-TW">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://dkchange.github.io/page/7/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-TW'
  };
</script>

  <title>蛋粒個人網誌</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">蛋粒個人網誌</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Stanley Ke</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">78</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">44</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">
      

      
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2019/11/15/laravel%E4%BD%BF%E7%94%A8lighthouse/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/15/laravel%E4%BD%BF%E7%94%A8lighthouse/" class="post-title-link" itemprop="url">laravel使用lighthouse</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2019-11-15 20:20:12" itemprop="dateCreated datePublished" datetime="2019-11-15T20:20:12+08:00">2019-11-15</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2020-01-20 18:02:06" itemprop="dateModified" datetime="2020-01-20T18:02:06+08:00">2020-01-20</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/" itemprop="url" rel="index"><span itemprop="name">後端路線</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/framework/" itemprop="url" rel="index"><span itemprop="name">framework</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/framework/laravel/" itemprop="url" rel="index"><span itemprop="name">laravel</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="介紹"><a href="#介紹" class="headerlink" title="介紹"></a>介紹</h1><p>因為graphql太紅，所以要來找找laravel上面如何應用，<a href="https://lighthouse-php.com/" target="_blank" rel="noopener">lighthouse</a>就是其中一款比較熱門的套件，那在應用上就要多看官網的文件了，遇到坑會再更新上來</p>
<h1 id="安裝步驟"><a href="#安裝步驟" class="headerlink" title="安裝步驟"></a>安裝步驟</h1><p>跟著官網做就會成功，除了1G的記憶體composer跑不起來以外，沒什大問題</p>
<h1 id="客製化查詢"><a href="#客製化查詢" class="headerlink" title="客製化查詢"></a>客製化查詢</h1><p>如果遇到需要太複雜，內建指令無法應付，客製化查詢的語句，就可以建一個class來搭配eloquent做應用</p>
<pre><code>php artisan lighthouse:query customerQuery</code></pre><h1 id="測試工具"><a href="#測試工具" class="headerlink" title="測試工具"></a>測試工具</h1><p>神器postman支援graphql囉，如果本機是6.X的版本要煮度上網去下載7.X的，自動更新不會幫你更到7.X</p>
<h1 id="laravel-跨站設定"><a href="#laravel-跨站設定" class="headerlink" title="laravel 跨站設定"></a>laravel 跨站設定</h1><p>最簡單的方法就是</p>
<pre><code>composer require barryvdh/laravel-cors</code></pre><p>然後進到</p>
<pre><code>config\lighthouse.php</code></pre><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'middleware'</span> =&gt; [</span><br><span class="line">    \Nuwave\Lighthouse\Support\Http\Middleware\AcceptJson::class,</span><br><span class="line">    \Barryvdh\Cors\HandleCors::class</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h1 id="文件上傳設定"><a href="#文件上傳設定" class="headerlink" title="文件上傳設定"></a>文件上傳設定</h1><p>跟著lighthouse官網做，其中測試檔案上傳 -k允許不安全連線</p>
<pre><code>curl -k https://dkchange.nctu.me/graphql   -F operations=&apos;{ &quot;query&quot;: &quot;mutation ($file: Upload!) { upload(file: $file) }&quot;, &quot;variables&quot;: { &quot;file&quot;: null } }&apos;   -F map=&apos;{ &quot;0&quot;: [&quot;variables.file&quot;] }&apos;   -F 0=@my_file.txt</code></pre><p>resolver那邊laravel<br>$file-&gt;storePublicly(‘uploads’)會出現在<code>myproject/storage/app/uploads/</code><br>那使用者怎麼存取?<br>artisan 提供一個指令</p>
<p>php artisan storage:link<br>下完之後就會把sotrage的public資料夾複製一分到public底下，阿記得這種方式沒有權限控管</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2019/11/08/laravel%E6%AC%84%E4%BD%8D%E9%A9%97%E8%AD%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/08/laravel%E6%AC%84%E4%BD%8D%E9%A9%97%E8%AD%89/" class="post-title-link" itemprop="url">laravel欄位驗證</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2019-11-08 02:15:08" itemprop="dateCreated datePublished" datetime="2019-11-08T02:15:08+08:00">2019-11-08</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2020-01-20 18:02:06" itemprop="dateModified" datetime="2020-01-20T18:02:06+08:00">2020-01-20</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/" itemprop="url" rel="index"><span itemprop="name">後端路線</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/framework/" itemprop="url" rel="index"><span itemprop="name">framework</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/framework/laravel/" itemprop="url" rel="index"><span itemprop="name">laravel</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>欄位驗證一般都放在request裡或controller裡，我偏好放在request裡面就做驗證，<br>為什麼欄位驗證要和request綁一起呢?<br>因為現在幾乎前後端分離，假如有天同時要做傳統的頁面和分離API頁面，兩個不同的controller才會請求都有被驗證，而且不用進到controller就擋下來，省時</p>
<h1 id="特別規則"><a href="#特別規則" class="headerlink" title="特別規則"></a>特別規則</h1><p>*sometimes<br>有填的時候再做驗證</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2019/11/07/laravel%E6%9C%83%E5%93%A1%E7%99%BB%E5%85%A5%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/07/laravel%E6%9C%83%E5%93%A1%E7%99%BB%E5%85%A5%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">laravel會員登入配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2019-11-07 20:46:04" itemprop="dateCreated datePublished" datetime="2019-11-07T20:46:04+08:00">2019-11-07</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2020-01-27 19:37:25" itemprop="dateModified" datetime="2020-01-27T19:37:25+08:00">2020-01-27</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/" itemprop="url" rel="index"><span itemprop="name">後端路線</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/framework/" itemprop="url" rel="index"><span itemprop="name">framework</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/framework/laravel/" itemprop="url" rel="index"><span itemprop="name">laravel</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>幾乎每個網站都會有會員機制，所以laravel就幫我們串好了</p>
<h1 id="make-auth"><a href="#make-auth" class="headerlink" title="make:auth"></a>make:auth</h1><p>下完這段指令，laravel自動建會員登入系統</p>
<pre><code>php artisan make:auth</code></pre><p>laravel在6.0之後把這功能抽出來</p>
<pre><code>composer require laravel/ui
php artisan ui vue --auth</code></pre><p>執行之後的效果是一樣的<br>路由就會多了Auth::route();這個方法事實上就是幫我們添加以下的路由</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Authentication Routes...</span></span><br><span class="line"><span class="keyword">$this</span>-&gt;get(<span class="string">'login'</span>, <span class="string">'Auth\LoginController@showLoginForm'</span>)-&gt;name(<span class="string">'login'</span>);</span><br><span class="line"><span class="keyword">$this</span>-&gt;post(<span class="string">'login'</span>, <span class="string">'Auth\LoginController@login'</span>);</span><br><span class="line"><span class="keyword">$this</span>-&gt;post(<span class="string">'logout'</span>, <span class="string">'Auth\LoginController@logout'</span>)-&gt;name(<span class="string">'logout'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Registration Routes...</span></span><br><span class="line"><span class="keyword">$this</span>-&gt;get(<span class="string">'register'</span>, <span class="string">'Auth\RegisterController@showRegistrationForm'</span>)-&gt;name(<span class="string">'register'</span>);</span><br><span class="line"><span class="keyword">$this</span>-&gt;post(<span class="string">'register'</span>, <span class="string">'Auth\RegisterController@register'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Password Reset Routes...</span></span><br><span class="line"><span class="keyword">$this</span>-&gt;get(<span class="string">'password/reset'</span>, <span class="string">'Auth\ForgotPasswordController@showLinkRequestForm'</span>);</span><br><span class="line"><span class="keyword">$this</span>-&gt;post(<span class="string">'password/email'</span>, <span class="string">'Auth\ForgotPasswordController@sendResetLinkEmail'</span>);</span><br><span class="line"><span class="keyword">$this</span>-&gt;get(<span class="string">'password/reset/&#123;token&#125;'</span>, <span class="string">'Auth\ResetPasswordController@showResetForm'</span>);</span><br><span class="line"><span class="keyword">$this</span>-&gt;post(<span class="string">'password/reset'</span>, <span class="string">'Auth\ResetPasswordController@reset'</span>);</span><br></pre></td></tr></table></figure>

<p>要客製前台的話，就近去個別controller做修改或Override即可，像是<br>改會員登入畫面<br>Controllers\Auth\LoginController.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showLoginForm</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">'admin.login'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>那如果我們要建個後臺，用不同的表儲存管理人員呢?<br>這問題牽扯到使用者和管理這484相同的生物了，例如銀行，我們可以看看大家的討論<br><a href="https://stackoverflow.com/questions/4169893/is-it-good-database-design-to-have-admin-users-in-the-same-table-as-front-end-us" target="_blank" rel="noopener">Is it good database design to have admin users in the same table as front-end users?</a><br><a href="https://mp.weixin.qq.com/s/wox0f-bl9E7qAl3pXuuMTg" target="_blank" rel="noopener">超全面的权限系统设计方案！</a><br>本篇主要探討製作後台頁面</p>
<h1 id="創建資料表"><a href="#創建資料表" class="headerlink" title="創建資料表"></a>創建資料表</h1><pre><code>php artisan make:model Admin -a
設定好欄位
php artisan migrate</code></pre><h1 id="塞資料"><a href="#塞資料" class="headerlink" title="塞資料"></a>塞資料</h1><p>後台不像前台有註冊頁面，所以，比較合理的方法就是把admin這些管理者寫進seed</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DB::table('admins')-&gt;insert([</span></span><br><span class="line"><span class="comment">//     'username' =&gt; 'admin',</span></span><br><span class="line"><span class="comment">//     'password' =&gt; Hash::make('password'),</span></span><br><span class="line"><span class="comment">//     'api_token'=&gt; Str::random(32),</span></span><br><span class="line"><span class="comment">//     'created_at' =&gt; Carbon::now()-&gt;format('Y-m-d H:i:s'),</span></span><br><span class="line"><span class="comment">//     'updated_at' =&gt; Carbon::now()-&gt;format('Y-m-d H:i:s')</span></span><br><span class="line"><span class="comment">// ]);</span></span><br><span class="line"><span class="comment">// Auto timestamp saving is only for Eloquent feature so you need to do manually like below for non eloquent feature</span></span><br><span class="line">Admin::create([</span><br><span class="line">    <span class="string">'username'</span> =&gt; <span class="string">'admin'</span>,</span><br><span class="line">    <span class="string">'password'</span> =&gt; Hash::make(<span class="string">'password'</span>),</span><br><span class="line">    <span class="string">'api_token'</span>=&gt; Str::random(<span class="number">32</span>), </span><br><span class="line">]);</span><br></pre></td></tr></table></figure>

<pre><code>php artisan db:seed</code></pre><h1 id="使用者和資料庫做認證"><a href="#使用者和資料庫做認證" class="headerlink" title="使用者和資料庫做認證"></a>使用者和資料庫做認證</h1><p>因為laravel 有內建認證會員了，<br>所以我們只要後台的會員認證即可</p>
<h2 id="config-auth-php"><a href="#config-auth-php" class="headerlink" title="config\auth.php"></a>config\auth.php</h2><p>添加下面的code進guards、providers這兩個key下面</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'guards'</span> =&gt; [</span><br><span class="line">    <span class="string">'admin'</span> =&gt; [</span><br><span class="line">        <span class="string">'driver'</span> =&gt; <span class="string">'session'</span>,</span><br><span class="line">        <span class="string">'provider'</span> =&gt; <span class="string">'admins'</span>,<span class="comment">//對應下面provider的admins</span></span><br><span class="line">    ],</span><br><span class="line">],</span><br><span class="line"><span class="string">'providers'</span> =&gt; [</span><br><span class="line">    <span class="string">'admins'</span> =&gt; [</span><br><span class="line">        <span class="string">'driver'</span> =&gt; <span class="string">'eloquent'</span>,</span><br><span class="line">        <span class="string">'model'</span> =&gt; App\Admin::class,</span><br><span class="line">    ],</span><br><span class="line">],</span><br></pre></td></tr></table></figure>



<h2 id="Controllers-Admin-LoginController-php"><a href="#Controllers-Admin-LoginController-php" class="headerlink" title="Controllers\Admin\LoginController.php"></a>Controllers\Admin\LoginController.php</h2><p>建controller</p>
<pre><code>php artisan make:controller Admin/LoginController</code></pre><p>以下為食用方式</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Controller</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Auth</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//驗證方式切到admin，配合config/auth設定的prvider進行驗證</span></span><br><span class="line">Auth::guard(<span class="string">'admin'</span>)-&gt;attempt([</span><br><span class="line">        <span class="string">'username'</span> =&gt; $request-&gt;input(<span class="string">'username'</span>),</span><br><span class="line">        <span class="string">'password'</span> =&gt; $request-&gt;input(<span class="string">'password'</span>)</span><br><span class="line">    ]);</span><br></pre></td></tr></table></figure>

<h2 id="App-Admin-php"><a href="#App-Admin-php" class="headerlink" title="App\Admin.php"></a>App\Admin.php</h2><p>因為admin model並沒有驗證功能，所以需要繼承Illuminate\Foundation\Auth\User</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Foundation</span>\<span class="title">Auth</span>\<span class="title">User</span> <span class="title">as</span> <span class="title">Authenticatable</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Admin</span> <span class="keyword">extends</span> <span class="title">Authenticatable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>設定完驗證就能用了</p>
<h1 id="防止未登入使用者，繞過登入頁直接存取"><a href="#防止未登入使用者，繞過登入頁直接存取" class="headerlink" title="防止未登入使用者，繞過登入頁直接存取"></a>防止未登入使用者，繞過登入頁直接存取</h1><p>為防止使用者直接存取後台頁面，我們每一個請求都要做驗證，那這個時候就需要中間件了</p>
<h2 id="Middleware-AdminMiddleware-php"><a href="#Middleware-AdminMiddleware-php" class="headerlink" title="Middleware\AdminMiddleware.php"></a>Middleware\AdminMiddleware.php</h2><p>建middleware<br>     php artisan make:middleware AdminMiddleware</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!Auth::guard(<span class="string">'admin'</span>)-&gt;check()) &#123;</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">'/'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="app-Http-Kernel-php"><a href="#app-Http-Kernel-php" class="headerlink" title="app\Http\Kernel.php"></a>app\Http\Kernel.php</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> $routeMiddleware = [</span><br><span class="line">    <span class="string">'admin.auth'</span>=&gt;\App\Http\Middleware\AdminMiddleware::class,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<h2 id="Controllers-Admin-LoginController-php-1"><a href="#Controllers-Admin-LoginController-php-1" class="headerlink" title="Controllers\Admin\LoginController.php"></a>Controllers\Admin\LoginController.php</h2><p>以下為中間件的食用方式，添加在建構子，或是個別路由</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//必須要略過登陸頁路由，因為我們需要給未登入的人用爾且我們驗證失敗會倒到這裡，會形成無窮迴圈</span></span><br><span class="line">    <span class="comment">//必須要略過登陸驗證路由，因為我們需要給未登入的人用</span></span><br><span class="line">    <span class="keyword">$this</span>-&gt;middleware(<span class="string">'admin.auth'</span>)-&gt;except([<span class="string">'loginForm'</span>,<span class="string">'login'</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>這邊有個省事的小秘訣，每次要用Auth的時候都需要先調用guard(‘admin’)，有個<a href="https://github.com/laravel/framework/issues/19547" target="_blank" rel="noopener">直接切換的方法</a></p>
<pre><code>//放在route裡面判斷即可，超省事
Auth::shouldUse(&apos;admin&apos;);</code></pre>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2019/11/07/laravel%E4%BD%BF%E7%94%A8%E4%BD%BF%E7%94%A8%E8%80%85%E8%AA%8D%E8%AD%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/07/laravel%E4%BD%BF%E7%94%A8%E4%BD%BF%E7%94%A8%E8%80%85%E8%AA%8D%E8%AD%89/" class="post-title-link" itemprop="url">laravel使用使用者認證</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2019-11-07 20:46:04" itemprop="dateCreated datePublished" datetime="2019-11-07T20:46:04+08:00">2019-11-07</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-03-24 06:42:30" itemprop="dateModified" datetime="2023-03-24T06:42:30+08:00">2023-03-24</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/" itemprop="url" rel="index"><span itemprop="name">後端路線</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/framework/" itemprop="url" rel="index"><span itemprop="name">framework</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/framework/laravel/" itemprop="url" rel="index"><span itemprop="name">laravel</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><a href="https://mp.weixin.qq.com/s/2Zu4XVhomoPjM6mAj1dFIw" target="_blank" rel="noopener">聊聊 Web API 认证方案那点儿事</a></p>
<p>前後端分離需要驗證，那怎樣讓會員可以不透過session維持登入狀態呢?<br>laravel 內建有種驗證方式，可參考<a href="https://learnku.com/articles/17867" target="_blank" rel="noopener">简聊 Session 与 Token 身份验证</a></p>
<ul>
<li>seesion</li>
<li>token<br>可以外掛</li>
<li>jwt 可參考<a href="https://learnku.com/articles/13592/api-development-can-choose-to-pass-a-pit-encountered-by-token-interface" target="_blank" rel="noopener">API 开发中可选择传递 token 接口遇到的一个坑</a></li>
<li>passport<br>session就不贅述，這邊主要介紹api_token和passport的方式<br>那官網一直到laravel 5.8 才有對<a href="https://laravel.com/docs/5.8/api-authentication" target="_blank" rel="noopener">api API Authentication</a> 的token做出獨立的文件，<br>之前有關於API Authentication的介紹都是passport，5.8以後passport才被移到官方套件欄位<h1 id="token"><a href="#token" class="headerlink" title="token"></a>token</h1><h2 id="內建token缺什麼"><a href="#內建token缺什麼" class="headerlink" title="內建token缺什麼?"></a>內建token缺什麼?</h2>官方並沒有提供api_token的更新方式，也就是說，<br>以session為例，你web用session登出sessionID會失效，<br>那按照這道理，你api登出api_token也要失效，<br>否則你的api還是可以被訪問的，這樣大不如api也用session來guard?<br>要怎解決這問題?<br>用jwt或passport<br>或<br>實作登入登出刷新token 可參考<a href="https://learnku.com/articles/11006/detailed-explanation-of-laravels-own-api-guard-drive-token" target="_blank" rel="noopener">Laravel 自带的 API 守卫驱动 token 使用详解</a></li>
</ul>
<h1 id="passport"><a href="#passport" class="headerlink" title="passport"></a>passport</h1><p>laravel 的API驗證API Authentication(passport)官網推薦</p>
<pre><code>composer require laravel/passport
php artisan passport:install --force</code></pre><p>先把預設相關的表建到資料庫</p>
<pre><code>php artisan migrate</code></pre><p>然後跟著官網</p>
<h1 id="遭遇問題"><a href="#遭遇問題" class="headerlink" title="遭遇問題"></a>遭遇問題</h1><p>Encryption keys already exist. Use the –force option to overwrite them.</p>
<h1 id="支援graphQL"><a href="#支援graphQL" class="headerlink" title="支援graphQL"></a>支援graphQL</h1><pre><code>composer require joselfonseca/lighthouse-graphql-passport-auth</code></pre><p>header如果有多欄位會報錯(註解不也不行)，原因不明<br>例如在header多加//Content-Type已經註解起來了也不行<br>Syntax Error: Unexpected <EOF></p>
<h1 id="遭遇狀況"><a href="#遭遇狀況" class="headerlink" title="遭遇狀況"></a>遭遇狀況</h1><p>GuzzleHttp Hangs When Using Localhost<br>not localhost but multiple requests for a single-threaded web server are the problem. You still can use artisan, but you have to run another instance on another port e.g. with php artisan serve –port=8001 and tell Guzzle to use this base_uri (<a href="http://localhost:8001" target="_blank" rel="noopener">http://localhost:8001</a>) instead<br><a href="https://stackoverflow.com/questions/48841018/guzzle-cannot-make-get-request-to-the-localhost-port-80-8000-8080-etc/57573002#57573002" target="_blank" rel="noopener">https://stackoverflow.com/questions/48841018/guzzle-cannot-make-get-request-to-the-localhost-port-80-8000-8080-etc/57573002#57573002</a><br><a href="https://stackoverflow.com/questions/36947844/guzzlehttp-hangs-when-using-localhost" target="_blank" rel="noopener">https://stackoverflow.com/questions/36947844/guzzlehttp-hangs-when-using-localhost</a></p>
<h1 id="延伸閱讀-自定義認證"><a href="#延伸閱讀-自定義認證" class="headerlink" title="延伸閱讀-自定義認證"></a>延伸閱讀-自定義認證</h1><p>[基于 Laravel Auth 实现自定义接口 API 用户认证详解]<a href="https://learnku.com/articles/14136/realization-of-user-interface-authentication-for-user-interface-api-based-on-laravel-auth?order_by=vote_count&amp;" target="_blank" rel="noopener">https://learnku.com/articles/14136/realization-of-user-interface-authentication-for-user-interface-api-based-on-laravel-auth?order_by=vote_count&amp;</a></p>
<p><a href="https://jsnwork.kiiuo.com/archives/2937/laravel-api-oauth2-%E6%9E%B6%E8%A8%AD/" target="_blank" rel="noopener">https://jsnwork.kiiuo.com/archives/2937/laravel-api-oauth2-%E6%9E%B6%E8%A8%AD/</a></p>
<h1 id="JWT-VS-Session"><a href="#JWT-VS-Session" class="headerlink" title="JWT VS Session"></a>JWT VS Session</h1><p><a href="https://zhuanlan.zhihu.com/p/38942172" target="_blank" rel="noopener">不要用JWT替代session管理（上）</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2019/11/07/%E4%B8%8D%E5%B8%B8%E7%94%A8%E6%9C%83%E5%BF%98%E7%9A%84linux%E6%8C%87%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/07/%E4%B8%8D%E5%B8%B8%E7%94%A8%E6%9C%83%E5%BF%98%E7%9A%84linux%E6%8C%87%E4%BB%A4/" class="post-title-link" itemprop="url">不常用會忘的linux指令</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2019-11-07 16:17:32" itemprop="dateCreated datePublished" datetime="2019-11-07T16:17:32+08:00">2019-11-07</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-03-18 11:04:33" itemprop="dateModified" datetime="2023-03-18T11:04:33+08:00">2023-03-18</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DevOps%E8%B7%AF%E7%B7%9A/" itemprop="url" rel="index"><span itemprop="name">DevOps路線</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DevOps%E8%B7%AF%E7%B7%9A/%E7%AE%A1%E7%90%86%E4%BC%BA%E6%9C%8D%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">管理伺服器</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DevOps%E8%B7%AF%E7%B7%9A/%E7%AE%A1%E7%90%86%E4%BC%BA%E6%9C%8D%E5%99%A8/%E4%BD%9C%E6%A5%AD%E7%B3%BB%E7%B5%B1/" itemprop="url" rel="index"><span itemprop="name">作業系統</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="改變資料夾底下檔案的預設權限"><a href="#改變資料夾底下檔案的預設權限" class="headerlink" title="改變資料夾底下檔案的預設權限"></a>改變資料夾底下檔案的預設權限</h1><p>使用場景，常常在遠程修改線上的電腦(例如docker container)，要透過網頁走php-fpm新增檔案， 但是資料夾775權限 group stanley一直都不是 nginx 在php-fpm設定的www-data，所以php-fpm無權限新增<br>如果你是用container，你會發現ll指令會print出userid 1000和groupid 1000<br>此時你需要在container增加user</p>
<blockquote>
<p>useradd -u 1000 stanley<br>此時我們可以把www-data加到stanley的group<br>usermod -a -G stanley www-data<br>加完之後確認是否有在群組內<br>getent group stanley<br>帳號重登一次電腦，如果是container就restart<br>之後www-data就有權限創檔案了<br>但是www-data創建出來的檔案換成遠端的stanley無法對其進行修改<br>因為檔案的user和group都是www-data<br>此時我們在透過網頁創建檔案之前<br>chmod g+s .;<br>This command sets the group ID (setgid) on the current directory, written as ..<br>This means that all new files and subdirectories created within the current directory inherit the group ID of the directory, rather than the primary group ID of the user who created the file. This will also be passed on to new subdirectories created in the current directory.<br>g+s affects the file’s group ID but does not affect the owner ID.</p>
</blockquote>
<p>Note that this applies only to newly-created files. Files that are moved (mv) into the directory are unaffected by the setgid setting. Files that are copied with cp -p are also unaffected.<br>chmod g+s <directory> //set gid</p>
<p>特殊權限</p>
<blockquote>
<p>setfacl -m u:stanley:rwx /www/index.php<br>setfacl -d -m g::rwx /<directory> //set group to rwx default<br>setfacl -d -m o::rx /<directory> //set other<br>setfacl 命令是用来在命令行里设置 ACL（访问控制列表)<br>getfacl /<directory><br>getfacl 來查看檔案的所有權限，也會把特殊權限的使用者列出來</p>
</blockquote>
<h1 id="不存在的使用者"><a href="#不存在的使用者" class="headerlink" title="不存在的使用者"></a>不存在的使用者</h1><p><a href="https://unix.stackexchange.com/questions/305170/is-it-ok-to-have-files-owned-by-a-non-existent-user" target="_blank" rel="noopener">Is it ok to have files owned by a non-existent user?</a><br>Yes, it’s fine.<br>在掛載 docker volume 的時候就會發現檔案的 user 是 1001 這個 uid</p>
<h1 id="hitory-儲存指令"><a href="#hitory-儲存指令" class="headerlink" title="hitory 儲存指令"></a>hitory 儲存指令</h1><p>有的時候你有沒有想過為什麼 git bash 沒有儲存你之前打的指令，<br>因為你沒有打 exit 或是 ctrl + c ，你直接就跳離開，這樣他不會儲存<br>.bash_history 這個檔案</p>
<h1 id="window-打開檔案縂管"><a href="#window-打開檔案縂管" class="headerlink" title="window 打開檔案縂管"></a>window 打開檔案縂管</h1><p>要在 window 打開檔案縂管</p>
<blockquote>
<p>start .</p>
</blockquote>
<h1 id="环境变数"><a href="#环境变数" class="headerlink" title="环境变数"></a>环境变数</h1><p>有的时候我们软体不是安装在全局的资料夹，系统在全局资料夹底下就找不到该软体，那我们可以怎么做？<br>就是设定环境变数，这样以后下程式指令就不会找不到 command 了，所以<br>设定取决于你是用那一款 shell 软体<br><a href="https://stackoverflow.com/questions/25373188/how-to-place-the-composer-vendor-bin-directory-in-your-path" target="_blank" rel="noopener">https://stackoverflow.com/questions/25373188/how-to-place-the-composer-vendor-bin-directory-in-your-path</a></p>
<h2 id="linux-變數設定"><a href="#linux-變數設定" class="headerlink" title="linux 變數設定"></a>linux 變數設定</h2><p>linux<br><a href="https://www.cnblogs.com/flying-tiger/p/5616934.html" target="_blank" rel="noopener">https://www.cnblogs.com/flying-tiger/p/5616934.html</a><br><a href="https://blog.csdn.net/GYQJN/article/details/50818231" target="_blank" rel="noopener">https://blog.csdn.net/GYQJN/article/details/50818231</a></p>
<h2 id="windows-變數設定"><a href="#windows-變數設定" class="headerlink" title="windows 變數設定"></a>windows 變數設定</h2><p>假如在环境变量新增了<br>变量名 stanley<br>变量值 php D:\stanley.phar<br>那 CMD 呼叫时<br>%stanley% run<br>相当于<br>php D:\stanley.phar run</p>
<p><a href="http://batcheero.blogspot.com/2008/02/set-and-setx.html" target="_blank" rel="noopener">http://batcheero.blogspot.com/2008/02/set-and-setx.html</a><br><a href="https://www.mobile01.com/topicdetail.php?f=300&amp;t=723300" target="_blank" rel="noopener">https://www.mobile01.com/topicdetail.php?f=300&amp;t=723300</a></p>
<h1 id="安裝-GD-Graphics-Library"><a href="#安裝-GD-Graphics-Library" class="headerlink" title="安裝 GD Graphics Library"></a>安裝 GD Graphics Library</h1><p>GD Library extension not available with this PHP installation Ubuntu Nginx<br><a href="https://stackoverflow.com/questions/34009844/gd-library-extension-not-available-with-this-php-installation-ubuntu-nginx" target="_blank" rel="noopener">https://stackoverflow.com/questions/34009844/gd-library-extension-not-available-with-this-php-installation-ubuntu-nginx</a></p>
<h1 id="找-ip"><a href="#找-ip" class="headerlink" title="找 ip"></a>找 ip</h1><p>ifconfig | grep 192</p>
<p>ifconfig: command not found<br>netstat command not found<br>這是因為在 RHEL / CentOS 7 開始, 最小化安裝不會包括 ifconfig 及 netstat 等工具, 以前在 CentOS 5 及 6 都是預設安裝的.<br>yum install net-tools</p>
<h1 id="查看網路使用狀態"><a href="#查看網路使用狀態" class="headerlink" title="查看網路使用狀態"></a>查看網路使用狀態</h1><p>netstat -natpe</p>
<h1 id="列出被程序開啟的檔案"><a href="#列出被程序開啟的檔案" class="headerlink" title="列出被程序開啟的檔案"></a>列出被程序開啟的檔案</h1><p>lsof -i<br>COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME<br>nginx 9 root 8u IPv4 10172200 0t0 TCP *:http (LISTEN)<br>php-fpm 12 root 9u IPv4 10171176 0t0 TCP localhost:cslistener (LISTEN)</p>
<h1 id="删除资料夹和檔案"><a href="#删除资料夹和檔案" class="headerlink" title="删除资料夹和檔案"></a>删除资料夹和檔案</h1><p>rm -rf letters/</p>
<h1 id="查看已安装套件"><a href="#查看已安装套件" class="headerlink" title="查看已安装套件"></a>查看已安装套件</h1><p>apt-get 也是 dpkg 的包装<br>直接使用 dpkg -l 来查看已经安装了的软件</p>
<blockquote>
<p>dpkg -l | grep php</p>
</blockquote>
<h1 id="查询安装路径"><a href="#查询安装路径" class="headerlink" title="查询安装路径"></a>查询安装路径</h1><blockquote>
<p>dpkg -L 软件名<br>whereis php7.3</p>
</blockquote>
<h1 id="切换-PHP-版本"><a href="#切换-PHP-版本" class="headerlink" title="切换 PHP 版本"></a>切换 PHP 版本</h1><p>php cli 可以透過 update-alternatives 來進行版本切換<br><a href="https://xenby.com/b/169-%E6%95%99%E5%AD%B8-%E5%9C%A8ubuntu%E5%AE%89%E8%A3%9D%E5%A4%9A%E7%89%88%E6%9C%ACphp-apache" target="_blank" rel="noopener">在 ubuntu 安裝多版本 PHP</a></p>
<blockquote>
<p>sudo update-alternatives –set php /usr/bin/php7.3<br>sudo update-alternatives –set php /usr/bin/php5.6</p>
</blockquote>
<h1 id="查看-linux-版本"><a href="#查看-linux-版本" class="headerlink" title="查看 linux 版本"></a>查看 linux 版本</h1><blockquote>
<p>ls -l /etc/*release<br>lsb_release -a<br>uname -a<br>cat /proc/version</p>
</blockquote>
<h1 id="查看权限"><a href="#查看权限" class="headerlink" title="查看权限"></a>查看权限</h1><blockquote>
<p>ls -la /root</p>
</blockquote>
<h1 id="關閉-xwindow-的視窗"><a href="#關閉-xwindow-的視窗" class="headerlink" title="關閉 xwindow 的視窗"></a>關閉 xwindow 的視窗</h1><p>之後點選對應的視窗 x 按鈕</p>
<blockquote>
<p>xkill</p>
</blockquote>
<h1 id="看文件最後幾行"><a href="#看文件最後幾行" class="headerlink" title="看文件最後幾行"></a>看文件最後幾行</h1><p>tail -n 1000 看最後 1000 行<br>tail -n +1000 看 1000 行之後的內容</p>
<h1 id="Linux-如何找出佔用較大空間的檔案"><a href="#Linux-如何找出佔用較大空間的檔案" class="headerlink" title="Linux 如何找出佔用較大空間的檔案"></a>Linux 如何找出佔用較大空間的檔案</h1><p>最近家中的 linux 突然磁碟空間爆增!!!</p>
<p>到底是什麼檔案佔用了這些空間?</p>
<p>在找出大檔案時,又怎麼知道 Linux 剩餘磁碟空間呢?</p>
<p>df -h 就可以很清楚知道目前磁碟空間是使用多少了</p>
<p>至於如何找到佔用的檔案,可以利用以下指令</p>
<p>du: 計算目錄所使用的空間<br>sort: 將輸入的資料排序<br>head: 將輸入資料的最開頭幾行資料輸出</p>
<p>像如要找到 home 下最大前 5 名如下</p>
<p>du -a /home | sort -n -r | head -n 5</p>
<p>至於要找到磁碟佔用最大的檔案呢?</p>
<p>方式有好幾種:</p>
<p>第一種方式:</p>
<p>像是我們可以先至根目錄下利用</p>
<p>指令 du -h –max-depth=1</p>
<p>–max-depth 是表示查詢子目錄的層級</p>
<p>就可查到目錄佔用的情形,再到較大的目錄,重覆利用此指令去找出佔用較大的檔案</p>
<p>第二種方式:</p>
<p>利用 find 指令如</p>
<p>find / -type f -size +5G</p>
<p>我們可以利用此種方式找出大於 5G 的檔案</p>
<p>第三種方式:</p>
<p>find / -type f -exec du {} ; 2&gt;/dev/null |<br>sort -n | tail -n 10 | xargs -n 1 du -h 2&gt;/dev/null<br>“find / -type f” 的意思是「搜尋根目錄中的所有檔案」。</p>
<p>-exec du {} ;“ 代表「每個找到的檔案都用 du 指令執行以取得以 bytes 為單位的檔案大小資訊」。</p>
<p>“2&gt;/dev/null” 是指將所有的錯誤訊息丟棄。</p>
<p>“sort -n” 會將所有的檔案依大小列出，</p>
<p>“tail -n 10” 則是顯示最後 10 筆，兩個指令合起來就會顯示出依大小排序的前 10 大檔案</p>
<h1 id="symlink"><a href="#symlink" class="headerlink" title="symlink"></a>symlink</h1><p>ln -s /var/www /home/stanley/sites/www</p>
<h1 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h1><p>將一個文件合併到另一個文件<br>cat a.sh &gt;&gt; b.py</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF &gt;file2</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 111</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 5555</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> 333</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> EOF</span></span><br></pre></td></tr></table></figure>

<h1 id="cd-回上一頁"><a href="#cd-回上一頁" class="headerlink" title="cd 回上一頁"></a>cd 回上一頁</h1><blockquote>
<p>cd -</p>
</blockquote>
<h1 id="目前所在終端"><a href="#目前所在終端" class="headerlink" title="目前所在終端"></a>目前所在終端</h1><p>tty</p>
<h1 id="背景執行"><a href="#背景執行" class="headerlink" title="背景執行"></a>背景執行</h1><p>sleep 5000 &amp;<br>但終端機管掉就會消失<br>nohup sleep 5000 &amp;<br>終端機關掉也不會消失</p>
<h1 id="查詢進程"><a href="#查詢進程" class="headerlink" title="查詢進程"></a>查詢進程</h1><p>ps aux | grep sleep</p>
<h1 id="暫時切換前後台"><a href="#暫時切換前後台" class="headerlink" title="暫時切換前後台"></a>暫時切換前後台</h1><p>bg<br>fg<br>那如果是 vim 編輯到一半可以^+Z 到背景<br>fg 繼續回來編輯</p>
<h1 id="一個命令的輸出是下一個命令的輸入"><a href="#一個命令的輸出是下一個命令的輸入" class="headerlink" title="| 一個命令的輸出是下一個命令的輸入"></a>| 一個命令的輸出是下一個命令的輸入</h1><h2 id="tee-把內容複製到某文件"><a href="#tee-把內容複製到某文件" class="headerlink" title="|tee 把內容複製到某文件"></a>|tee 把內容複製到某文件</h2><p>會覆蓋掉檔案<br>例如<br>date &gt; date.txt<br>date |tee date.txt</p>
<h2 id="gt-gt-把內容複製到某文件的最後一行"><a href="#gt-gt-把內容複製到某文件的最後一行" class="headerlink" title="&gt;&gt; 把內容複製到某文件的最後一行"></a>&gt;&gt; 把內容複製到某文件的最後一行</h2><p>例如<br>date &gt;&gt; date.txt</p>
<h1 id="SSH-複製檔案"><a href="#SSH-複製檔案" class="headerlink" title="SSH 複製檔案"></a>SSH 複製檔案</h1><p>scp <a href="mailto:ubuntu@168.138.40.82" target="_blank" rel="noopener">ubuntu@168.138.40.82</a>:/srv/www/happypanda.subnet.vcn.oraclevcn.com/current/happypanda_subnet_vcn_oraclevcn_com_production-2020-08-30-5a26f48.sql /home/stanley/Downloads</p>
<p><a href="https://discourse.roots.io/t/migration-from-bedrock-to-a-normal-install/12551" target="_blank" rel="noopener">https://discourse.roots.io/t/migration-from-bedrock-to-a-normal-install/12551</a></p>
<h1 id="UNPROTECTED-PRIVATE-KEY-FILE"><a href="#UNPROTECTED-PRIVATE-KEY-FILE" class="headerlink" title="UNPROTECTED PRIVATE KEY FILE"></a>UNPROTECTED PRIVATE KEY FILE</h1><p><a href="https://stackabuse.com/how-to-fix-warning-unprotected-private-key-file-on-mac-and-linux/" target="_blank" rel="noopener">https://stackabuse.com/how-to-fix-warning-unprotected-private-key-file-on-mac-and-linux/</a></p>
<p>把權限改一下即可<br>sudo chmod 600 /path/to/my/key.pem</p>
<h1 id="匯入-匯出-sql"><a href="#匯入-匯出-sql" class="headerlink" title="匯入 匯出 sql"></a>匯入 匯出 sql</h1><p>sudo wp db export –add-drop-table –allow-root</p>
<p>docker-compose run –rm wordpress-cli db import happypanda_subnet_vcn_oraclevcn_com_production-2020-08-30-7da1ec2.sql</p>
<h1 id="開機就會執行的指令"><a href="#開機就會執行的指令" class="headerlink" title="開機就會執行的指令"></a>開機就會執行的指令</h1><p><a href="https://www.cnblogs.com/nerxious/archive/2013/01/18/2866548.HTML" target="_blank" rel="noopener">Linux中设置服务自启动的三种方式</a></p>
<p>會放在 /etc/rc.local 這個檔案裡面</p>
<p>大多時候我們可以在/etc/rc.local 中寫一些命令來啓動自己的程序或服務，但是配置後無法啓動，查看了下是 rc-local.service 未啓動<br>ConditionFileIsExecutable=/etc/rc.d/rc.local was not met<br>默認情況下，使用上面的命令無法啓動 rc-local.service 服務，原因是需要兩處文件都設置可執行權限，但是 /etc/rc.d/rc.local 默認沒有可執行權限<br><a href="https://stackoverflow.com/questions/43671482/how-to-run-docker-compose-up-d-at-system-start-up" target="_blank" rel="noopener">https://stackoverflow.com/questions/43671482/how-to-run-docker-compose-up-d-at-system-start-up</a></p>
<h2 id="設置可執行權限"><a href="#設置可執行權限" class="headerlink" title="設置可執行權限"></a>設置可執行權限</h2><p>[root@master ~]# chmod +x /etc/rc.d/rc.local<br>[root@master ~]# chmod +x /etc/rc.local</p>
<h1 id="檢查-TCP-port-有沒有開"><a href="#檢查-TCP-port-有沒有開" class="headerlink" title="檢查 TCP port 有沒有開"></a>檢查 TCP port 有沒有開</h1><p>telnet 域名 port 號</p>
<h1 id="檢查域名對應-ip"><a href="#檢查域名對應-ip" class="headerlink" title="檢查域名對應 ip"></a>檢查域名對應 ip</h1><p>ping 域名</p>
<h1 id="iptable-規則必須按順序放-然後重啟"><a href="#iptable-規則必須按順序放-然後重啟" class="headerlink" title="iptable 規則必須按順序放 然後重啟"></a>iptable 規則必須按順序放 然後重啟</h1><p><a href="https://www.itread01.com/articles/1487665153.html" target="_blank" rel="noopener">https://www.itread01.com/articles/1487665153.html</a><br>端口放行條目，請放在下列條目之前，然後修改後，重啟防火墻服務<br>-A INPUT -j REJECT –reject-with icmp-host-prohibited -A FORWARD -j REJECT –reject-with icmp-host-prohibited</p>
<p>service iptables restart</p>
<p>阿如果不想電腦重開機規則不見的話<br>可以修改以下檔案<br>/etc/sysconfig/iptables<br>或<br>service iptables save<br>也會存進去<br>/etc/sysconfig/iptables</p>
<p>在不然就是<br>保存规则：#iptables-save &gt;/etc/iptables-script<br>恢复规则：#iptables-restore&gt;/etc/iptables-script<br>开机自动恢复规则，把恢复命令添加到启动脚本：echo ‘/sbin/iptables-restore /etc/iptables-script’ &gt;&gt;/etc/rc.d/rc.local</p>
<h1 id="查看服務列表"><a href="#查看服務列表" class="headerlink" title="查看服務列表"></a>查看服務列表</h1><p>service –status-all<br>chkconfig –list</p>
<p>systemctl list-units –type=service</p>
<h1 id="查看硬碟用量"><a href="#查看硬碟用量" class="headerlink" title="查看硬碟用量"></a>查看硬碟用量</h1><p><a href="https://blog.csdn.net/qq_35076663/article/details/103556988?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.add_param_isCf&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.add_param_isCf" target="_blank" rel="noopener">https://blog.csdn.net/qq_35076663/article/details/103556988?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.add_param_isCf&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.add_param_isCf</a></p>
<p>du -hsx /data/www/lotteryhub/daemon/* | sort -hr | head</p>
<h1 id="修改使用者群組"><a href="#修改使用者群組" class="headerlink" title="修改使用者群組"></a>修改使用者群組</h1><p>當你修改使用者群組時，記得要將使用者登出後再登入，這樣才會成功被納入該群組<br>要知道有沒有被列入群組之中，用<code>id</code>指令即可查看</p>
<h1 id="掛載硬碟"><a href="#掛載硬碟" class="headerlink" title="掛載硬碟"></a>掛載硬碟</h1><p>mount /dev/sda1 /media/stanley/hdd</p>
<h1 id="找出重疊的指令"><a href="#找出重疊的指令" class="headerlink" title="找出重疊的指令"></a>找出重疊的指令</h1><p>grep -r listen /etc/nginx/*</p>
<h1 id="cron-自己的日誌"><a href="#cron-自己的日誌" class="headerlink" title="cron 自己的日誌"></a>cron 自己的日誌</h1><p><a href="https://serverfault.com/questions/136461/how-to-check-cron-logs-in-ubuntu?rq=1" target="_blank" rel="noopener">https://serverfault.com/questions/136461/how-to-check-cron-logs-in-ubuntu?rq=1</a></p>
<h1 id="cron-log-分檔"><a href="#cron-log-分檔" class="headerlink" title="cron log 分檔"></a>cron log 分檔</h1><p>logrotate<br><a href="https://stackoverflow.com/questions/53366062/creating-cron-job-that-sends-output-to-file-every-day-and-overwrites-this-file-e" target="_blank" rel="noopener">https://stackoverflow.com/questions/53366062/creating-cron-job-that-sends-output-to-file-every-day-and-overwrites-this-file-e</a></p>
<h1 id="linux-查看环境变量和修改环境变量"><a href="#linux-查看环境变量和修改环境变量" class="headerlink" title="linux 查看环境变量和修改环境变量"></a>linux 查看环境变量和修改环境变量</h1><p>“/etc/profile”对系统里所有用户都有效，用户主目录下的“.bash_profile”只对这个用户有效。<br><a href="https://blog.csdn.net/w6028819321/article/details/21600423" target="_blank" rel="noopener">https://blog.csdn.net/w6028819321/article/details/21600423</a></p>
<h1 id="搬移檔案，包括隱藏檔"><a href="#搬移檔案，包括隱藏檔" class="headerlink" title="搬移檔案，包括隱藏檔"></a>搬移檔案，包括隱藏檔</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -maxdepth 1 -<span class="built_in">exec</span> mv &#123;&#125; .. \;</span><br></pre></td></tr></table></figure>
<h1 id="新增加的群組組員無法在有群組權限的資料夾新增檔案"><a href="#新增加的群組組員無法在有群組權限的資料夾新增檔案" class="headerlink" title="新增加的群組組員無法在有群組權限的資料夾新增檔案"></a>新增加的群組組員無法在有群組權限的資料夾新增檔案</h1><ol>
<li>登出後重登</li>
<li><a href="https://superuser.com/questions/1620868/user-added-to-group-cant-create-files-or-folders-inside-group-owned-folder" target="_blank" rel="noopener">https://superuser.com/questions/1620868/user-added-to-group-cant-create-files-or-folders-inside-group-owned-folder</a></li>
</ol>
<p><a href="https://superuser.com/questions/665057/group-member-cannot-create-files-directories-in-folder" target="_blank" rel="noopener">https://superuser.com/questions/665057/group-member-cannot-create-files-directories-in-folder</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2019/11/06/%E7%94%B3%E8%AB%8BSSL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/06/%E7%94%B3%E8%AB%8BSSL/" class="post-title-link" itemprop="url">申請SSL</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2019-11-06 18:31:21" itemprop="dateCreated datePublished" datetime="2019-11-06T18:31:21+08:00">2019-11-06</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2021-07-30 18:17:40" itemprop="dateModified" datetime="2021-07-30T18:17:40+08:00">2021-07-30</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DevOps%E8%B7%AF%E7%B7%9A/" itemprop="url" rel="index"><span itemprop="name">DevOps路線</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DevOps%E8%B7%AF%E7%B7%9A/%E7%B6%B2%E8%B7%AF%E8%88%87%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">網路與安全</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DevOps%E8%B7%AF%E7%B7%9A/%E7%B6%B2%E8%B7%AF%E8%88%87%E5%AE%89%E5%85%A8/https/" itemprop="url" rel="index"><span itemprop="name">https</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="自簽名"><a href="#自簽名" class="headerlink" title="自簽名"></a>自簽名</h1><p>因為開發環境沒有 domain，可有些技術又強制要走 ssl，像是 webrtc 的其中一個環節<br><a href="https://help.fanruan.com/finereport/doc-view-2662.html" target="_blank" rel="noopener">https://help.fanruan.com/finereport/doc-view-2662.html</a></p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yum install openssl openssl-devel</span><br><span class="line">openssl version -a</span><br><span class="line">openssl genrsa -des3 -out server.key 2048</span><br><span class="line">openssl rsa -in server.key -out server.key</span><br><span class="line">openssl req -new -key server.key -out server.csr</span><br><span class="line">openssl req -new -x509 -key server.key -out ca.crt -days 3650</span><br><span class="line">openssl x509 -req -days 3650 -in server.csr -CA ca.crt -CAkey server.key -CAcreateserial -out server.crt</span><br></pre></td></tr></table></figure>

<p>之後在 nginx 做相關的設定</p>
<p>在 Chrome 的設定中，匯入憑證，再啟動 Chrom，就大功告成了<br><a href="https://ithelp.ithome.com.tw/articles/10230157" target="_blank" rel="noopener">https://ithelp.ithome.com.tw/articles/10230157</a></p>
<h1 id="憑證取得方法"><a href="#憑證取得方法" class="headerlink" title="憑證取得方法"></a>憑證取得方法</h1><p>憑證有分等級，最簡單的就是<strong>驗證網域 484 你的</strong>(傳檔案驗證 OR DNS 驗證)然後就發給你憑證，<br>阿高級一點的就須要人工的身份證明之類的東西<br>我們申請簡單的憑證，幾個方法</p>
<ol>
<li>手動生出 <strong>密鑰</strong> 密鑰再用來生成<strong>憑證簽屬請求檔</strong>，再拿這請求檔去跟各大平台，驗證網域 484 你的之後，拿<strong>憑證</strong>和<strong>中繼憑證</strong>回來</li>
<li>最簡單的方法，就是網路上有人做跟各憑證平台串接，做了方法 1 的事，生出 <strong>密鑰、憑證、中繼憑證</strong> 之後我們再載回來用，像是<a href="https://free.com.tw/ssl-for-free/" target="_blank" rel="noopener">https://free.com.tw/ssl-for-free/</a></li>
<li>用像是集成方法 2 功能的軟體，缺點是要打指令，優點是他可以自動排程更新憑證，DNS 驗證網域使用域名解析商提供的 API 來添加 TXT 達成驗證，像是 acme.sh</li>
</ol>
<h1 id="Let’s-Encrypt"><a href="#Let’s-Encrypt" class="headerlink" title="Let’s Encrypt"></a>Let’s Encrypt</h1><p>Let’s Encrypt ，沒有開放直接從網站輸入私密金鑰、CSR 檔案來取得憑證的介面<br>Let’s Encrypt 免費 SSL 憑證只有三個月的有效期<br>所以看來只能採第三種方法</p>
<h1 id="acme-sh"><a href="#acme-sh" class="headerlink" title="acme.sh"></a>acme.sh</h1><p>ACME(Automated Certificate Management Environment)自動證書管理環境<br>官網也有推別款，但我找到的<a href="https://magiclen.org/simple-ssl-acme-cloudflare/" target="_blank" rel="noopener">如何在 Linux 作業系統上免費申請 Let’s Encrypt 的 SSL 憑證，並實現自動化申請和套用</a>介紹的是這個</p>
<h1 id="安裝-acme-sh"><a href="#安裝-acme-sh" class="headerlink" title="安裝 acme.sh"></a>安裝 acme.sh</h1><p>接下來記錄安裝過程，因為有遇到困難，所以才有這篇 XD<br>跟著<a href="https://github.com/Neilpang/acme.sh/wiki/%E8%AF%B4%E6%98%8E" target="_blank" rel="noopener">說明書</a>做</p>
<p>在做這些動作之前，請切到 root，不然會有權限問題，也不要加 sudo 直接做，路徑會不在 root 底下，而且作者這樣說</p>
<blockquote>
<p><a href="https://github.com/Neilpang/acme.sh/issues/2124" target="_blank" rel="noopener">do not run as sudo</a></p>
</blockquote>
<pre><code>sudo su
下載
curl https://get.acme.sh | sh
更新
acme.sh --upgrade --auto-upgrade
出現問題**acme.sh: command not found**
解決辦法:https://github.com/Neilpang/acme.sh/issues/2149
source  ~/.bashrc

acme.sh --issue --nginx -d dkchange.nctu.me

手動更新，因為我的DNS是小家nctu.me沒人作API
acme.sh --issue -d dkchange.nctu.me --dns --yes-I-know-dns-manual-mode-enough-go-ahead-please
然後憑證就出來了


下次手動更新的時間，我們給他記起乃
[Wed Nov  6 11:26:47 UTC 2019] Skip, Next renewal time is: Sun Jan  5 11:05:26 UTC 2020
[Wed Nov  6 11:26:47 UTC 2019] Add &apos;--force&apos; to force to renew.
接著下次就醬
acme.sh --renew -d dkchange.nctu.me  --yes-I-know-dns-manual-mode-enough-go-ahead-please</code></pre><h1 id="nginx-設定"><a href="#nginx-設定" class="headerlink" title="nginx 設定"></a>nginx 設定</h1><p>先把這兩個檔案搬到讀的到的目錄</p>
<pre><code>cp fullchain.cer /home/fullchain.cer
cp dkchange.nctu.me.key /home/dkchange.nctu.me.key</code></pre><p>接著設定 nginx 設定檔</p>
<pre><code>server {
    listen 443 ssl default_server;
    listen [::]:443 ssl default_server;
    ssl_certificate /home/fullchain.cer;
    ssl_certificate_key /home/dkchange.nctu.me.key;
}

server {
        listen 80;
        listen [::]:80;

        server_name dkchange.nctu.me;
        return  301 https://$host$request_uri;
}</code></pre><p>服務重啟</p>
<pre><code>sudo systemctl restart nginx</code></pre><p>AWS 記得開 443port</p>
<p>Let’s Encrypt 也支援萬用 SSL 憑證，不限個數的子網域 但是<a href="https://github.com/Neilpang/acme.sh/issues/1433#issuecomment-377242752" target="_blank" rel="noopener">只支援 dns 驗證</a></p>
<pre><code>補憑證時下面這行因為通配符的子網域驗證只適用於-dns 伺服器-nginx 和檔案位置-w都不能用
acme.sh --issue -w /var/www/html/lighthouse-tutorial/public/  -d *.dkchange.nctu.me

所以nginx的conf檔也要改
server_name dkchange.nctu.me *.dkchange.nctu.me;
改成寫死的admin 驗證方式也要改，因為有設定301重導和https了，所以走模擬server請求的nginx結果會不同
acme.sh --issue -w /var/www/html/lighthouse-tutorial/public/  -d admin.dkchange.nctu.me
server_name dkchange.nctu.me admin.dkchange.nctu.me;</code></pre><p>哪天有閒錢再來買 godaddy 之類的，像<a href="https://footmark.info/linux/centos/acmesh-godaddy-letsencrypt-wildcard/" target="_blank" rel="noopener">這篇</a>和<a href="https://github.com/Neilpang/acme.sh/wiki/How-to-issue-a-cert#3-multiple-domains-san-mode--hybrid-mode" target="_blank" rel="noopener">https://github.com/Neilpang/acme.sh/wiki/How-to-issue-a-cert#3-multiple-domains-san-mode--hybrid-mode</a></p>
<h1 id="相關副檔名"><a href="#相關副檔名" class="headerlink" title="相關副檔名"></a>相關副檔名</h1><p>實在很令人混亂的東西，有時後叫 pem，有時後叫 crt，也有 cert 等等，結論就是我把 crt / key / ca 塞入的就叫 pem</p>
<p><a href="https://ssorc.tw/7142/openssl-%E6%8C%87%E4%BB%A4-command-line-%E8%BD%89%E6%AA%94-pem-der-p7b-pfx-cer/" target="_blank" rel="noopener">https://ssorc.tw/7142/openssl-%E6%8C%87%E4%BB%A4-command-line-%E8%BD%89%E6%AA%94-pem-der-p7b-pfx-cer/</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2019/11/05/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/05/%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B/" class="post-title-link" itemprop="url">名詞解釋</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2019-11-05 23:02:45" itemprop="dateCreated datePublished" datetime="2019-11-05T23:02:45+08:00">2019-11-05</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2021-07-30 18:11:28" itemprop="dateModified" datetime="2021-07-30T18:11:28+08:00">2021-07-30</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>OOP (Object-oriented Programming) e.g., C++, Enterprise JAVA, Object-oriented PHP</p>
<p>FP (Functional Programming) e.g., Haskell, Scheme, Erlang</p>
<p>AOP (Aspect Oriented Programming) e.g., AspectJ</p>
<p>COP (Concurrency Oriented Programming)</p>
<p><a href="https://sites.google.com/site/javacodelibrary/mda-tools/programming-paradigms" target="_blank" rel="noopener">https://sites.google.com/site/javacodelibrary/mda-tools/programming-paradigms</a></p>
<p>依賴注入控制反轉<br>直白的解釋，這一種現象，一種情況<br><a href="https://learnku.com/articles/5222/simply-explain-what-dependency-injection-and-control-inversion-are" target="_blank" rel="noopener">https://learnku.com/articles/5222/simply-explain-what-dependency-injection-and-control-inversion-are</a><br>那如何達成我們想要的情況就需要藉由容器來達成<br>依赖注入借用容器转移了被依赖对象实现解耦<br><a href="https://m.php.cn/article/302.html" target="_blank" rel="noopener">https://m.php.cn/article/302.html</a></p>
<p><a href="https://juejin.im/post/5baeeb5be51d450e99433e57" target="_blank" rel="noopener">https://juejin.im/post/5baeeb5be51d450e99433e57</a></p>
<p>命名規則<br><a href="https://dustinhsiao21.com/2019/03/14/naming-convention/" target="_blank" rel="noopener">https://dustinhsiao21.com/2019/03/14/naming-convention/</a><br>CamelCase<br>Pascal Case<br>Snake Case<br>Kebab Case</p>
<h1 id="kangle"><a href="#kangle" class="headerlink" title="kangle"></a>kangle</h1><p>跨平台 web 服务器</p>
<h1 id="腳手架"><a href="#腳手架" class="headerlink" title="腳手架"></a>腳手架</h1><p>由“程序员手写代码”跨越到了“程序员指挥机器自动生成代码”的时代<br><a href="https://www.zhihu.com/question/29075085" target="_blank" rel="noopener">https://www.zhihu.com/question/29075085</a></p>
<h1 id="知名專案管理軟體"><a href="#知名專案管理軟體" class="headerlink" title="知名專案管理軟體"></a>知名專案管理軟體</h1><p>bugfree，禅道，github，redmine，jira 等专案管理软体都可以</p>
<p>公司目前用的是禪道<br><a href="https://www.zentao.net/book//207.html" target="_blank" rel="noopener">https://www.zentao.net/book//207.html</a></p>
<h1 id="Authentication-vs-Authorization"><a href="#Authentication-vs-Authorization" class="headerlink" title="Authentication vs Authorization"></a>Authentication vs Authorization</h1><p>Authentication（驗證）：確認使用者是否真的是其所宣稱的那個人的過程。</p>
<p>Authorization（授權）：根據使用者的角色來授予應有的權限。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2019/11/05/%E8%A8%AD%E8%A8%88%E5%8E%9F%E5%89%87/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/05/%E8%A8%AD%E8%A8%88%E5%8E%9F%E5%89%87/" class="post-title-link" itemprop="url">設計原則</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2019-11-05 22:53:01" itemprop="dateCreated datePublished" datetime="2019-11-05T22:53:01+08:00">2019-11-05</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2022-02-17 10:00:42" itemprop="dateModified" datetime="2022-02-17T10:00:42+08:00">2022-02-17</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%BB%BB%E4%BD%95%E8%B7%AF%E7%B7%9A/" itemprop="url" rel="index"><span itemprop="name">任何路線</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%BB%BB%E4%BD%95%E8%B7%AF%E7%B7%9A/%E8%A8%AD%E8%A8%88%E5%8E%9F%E5%89%87/" itemprop="url" rel="index"><span itemprop="name">設計原則</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%BB%BB%E4%BD%95%E8%B7%AF%E7%B7%9A/%E8%A8%AD%E8%A8%88%E5%8E%9F%E5%89%87/%E8%A8%AD%E8%A8%88%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">設計模式</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%BB%BB%E4%BD%95%E8%B7%AF%E7%B7%9A/%E8%A8%AD%E8%A8%88%E5%8E%9F%E5%89%87/%E8%A8%AD%E8%A8%88%E6%A8%A1%E5%BC%8F/%E8%A8%AD%E8%A8%88%E8%A6%8F%E7%AF%84/" itemprop="url" rel="index"><span itemprop="name">設計規範</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>設計模式的 7 大原則<br>為了碼復用，增加可維護性,高內聚,低耦合<br>软件设计原则：原则为我们提供指南，它告诉我们什么是对的，什么是错的。它不会告诉我们如何解决问题。它仅仅给出一些准则，以便我们可以设计好的软件，避免不良的设计。一些常见的原则，比如DRY、OCP、DIP等</p>
<p>软件设计原则，它仅仅告诉你两个模块之间应该如何依赖，但是它并没有告诉如何做</p>
<p><a href="https://wiki.mbalib.com/zh-tw/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F" target="_blank" rel="noopener">https://wiki.mbalib.com/zh-tw/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F</a><br><a href="https://ithelp.ithome.com.tw/articles/10095511" target="_blank" rel="noopener">https://ithelp.ithome.com.tw/articles/10095511</a></p>
<h1 id="7-大设计原则"><a href="#7-大设计原则" class="headerlink" title="7 大设计原则"></a>7 大设计原则</h1><ol>
<li>單一職責原則（Single Responsibility Principle，SRP）</li>
<li>开闭原则（Open Close Principle）</li>
<li>里氏代换原则（Liskov Substitution Principle）</li>
<li>接口隔离原则（Interface Segregation Principle）</li>
<li>依赖倒转原则（Dependence Inversion Principle）</li>
</ol>
<p>以上5個原則的首字母聯合起來就是SOLID（solid，穩定的）</p>
<ol start="6">
<li>迪米特法则（Demeter Principle）又叫作最少知识原则（Least Knowledge Principle，LKP)、(Law of Demeter，LoD)</li>
<li>合成复用原则（Composite Reuse Principle）</li>
</ol>
<p>生活實例可以參考<br><a href="https://juejin.cn/post/6844903854174126088" target="_blank" rel="noopener">设计模式看了又忘，忘了又看</a><br>其他原則：<br>dry(Don’t repeat yourself)<br>kiss(keep it simple, stupid)<br>YAGNI(You aren’t gonna need it)<br>Hollywood Principle(Don’t call us, we’ll call you)</p>
<h2 id="solid"><a href="#solid" class="headerlink" title="solid"></a>solid</h2><h3 id="SRP-Single-Responsibility-Principle-單一職責原則"><a href="#SRP-Single-Responsibility-Principle-單一職責原則" class="headerlink" title="SRP Single Responsibility Principle 單一職責原則"></a>SRP Single Responsibility Principle 單一職責原則</h3><p>說明：做好職責劃分,邏輯和資料不混用<br>需要：method和interface必須遵守class可不必遵守<br>例子：註冊、登入<br>特例：active record 違反這項原則：換來快速的開發效率</p>
<h3 id="OCP-Open-Closed-Principle-開閉原則"><a href="#OCP-Open-Closed-Principle-開閉原則" class="headerlink" title="OCP Open Closed Principle 開閉原則"></a>OCP Open Closed Principle 開閉原則</h3><p>是說模塊應對擴展開放，而對修改關閉。模塊應儘量在不修改原（是“原”，指原來的代碼）代碼的情況下進行擴展<br>你可以去繼承該class但不要去修改該class<br>目的:我們常常有修A 錯B的情形發生，A可能被很多地方引用，用繼承的方式去擴展，才能減少這樣的事情發生</p>
<h3 id="LSP-Liskov-Substitution-Principle-里氏替換原則"><a href="#LSP-Liskov-Substitution-Principle-里氏替換原則" class="headerlink" title="LSP Liskov Substitution Principle 里氏替換原則"></a>LSP Liskov Substitution Principle 里氏替換原則</h3><p>主要講的是繼承,繼承會增加耦合性但是為了減少代碼又不可避免,就是教你<strong>好好的用繼承</strong><br>程式上只要父類別能出現的地方，子類別就可以出現，並且替換子類別不會產生任何錯誤或異常。但是反過來就不行，子類別能出現的地方，父類別未必能適應。<br>目的:假如所有繼承的方法，你都去overwrite ，那就違反此項原則，假如塑膠鴨子不會飛，你去繼承鴨子，那塑膠鴨子飛的方法被使用者使用時，就是你overwirte的結果，這樣就是錯誤的繼承，此時如果系統已經運行一陣子，被很多地方依賴，要修改就會是個地獄</p>
<h3 id="ISP-Interface-Segregation-Principles-介面隔離原則"><a href="#ISP-Interface-Segregation-Principles-介面隔離原則" class="headerlink" title="ISP Interface Segregation Principles 介面隔離原則"></a>ISP Interface Segregation Principles 介面隔離原則</h3><p>介面應該是一種角色，不多不少，不幹不該乾的事，該乾的事都要乾<br>不應該強迫用戶依賴它們未使用的方法，介面又會強迫實作，所以介面的職責要劃分清楚，不然會出現空實作之類的違反LSP<br>弱型別:<br><a href="https://igouist.github.io/post/2020/11/oo-13-interface-segregation-principle/" target="_blank" rel="noopener">https://igouist.github.io/post/2020/11/oo-13-interface-segregation-principle/</a><br>強型別:<br><a href="https://medium.com/%E7%A8%8B%E5%BC%8F%E6%84%9B%E5%A5%BD%E8%80%85/%E4%BD%BF%E4%BA%BA%E7%98%8B%E7%8B%82%E7%9A%84-solid-%E5%8E%9F%E5%89%87-%E4%BB%8B%E9%9D%A2%E9%9A%94%E9%9B%A2%E5%8E%9F%E5%89%87-interface-segregation-principle-50f54473c79e" target="_blank" rel="noopener">https://medium.com/%E7%A8%8B%E5%BC%8F%E6%84%9B%E5%A5%BD%E8%80%85/%E4%BD%BF%E4%BA%BA%E7%98%8B%E7%8B%82%E7%9A%84-solid-%E5%8E%9F%E5%89%87-%E4%BB%8B%E9%9D%A2%E9%9A%94%E9%9B%A2%E5%8E%9F%E5%89%87-interface-segregation-principle-50f54473c79e</a><br>目的: 我自己將其視為一種封裝，例如:我鴨子抽出 可以飛的介面出來，那如果你要可以飛，你就必須NEW這個有實做可以飛的Class</p>
<h3 id="DIP-Dependency-Inversion-Principle-依賴反轉原則"><a href="#DIP-Dependency-Inversion-Principle-依賴反轉原則" class="headerlink" title="DIP Dependency Inversion Principle 依賴反轉原則"></a>DIP Dependency Inversion Principle 依賴反轉原則</h3><p>高層模組不應依賴低層模組，兩者都應依賴其抽象,就是儘量用抽象和界面</p>
<p>依赖倒置原则，DIP,Dependency Inverse Principle DIP的表述是：</p>
<p>1、高层模块不应该依赖于低层模块, 二者都应该依赖于抽象。</p>
<p>2、抽象不应该依赖于细节,细节应该依赖于抽象。</p>
<p>这里说的“依赖”是使用的意思，如果你调用了一个类的一个方法，就是依赖这个类，如果你直接调用这个类的方法，就是依赖细节，细节就是具体的类，但如果你调用的是它父类或者接口的方法，就是依赖抽象， 所以 DIP 说白了就是不要直接使用具体的子类，而是用它的父类的引用去调用子类的方法，这样就是依赖于抽象，不依赖具体。</p>
<p>其实简单的说，DIP 的好处就是解除耦合，用了 DIP 之后，调用者就不知道被调用的代码是什么，因为调用者拿到的是父类的引用，它不知道具体指向哪个子类的实例，更不知道要调用的方法具体是什么，所以，被调用代码被偷偷换成另一个子类之后，调用者不需要做任何修改， 这就是解耦了。</p>
<p>耦合是怎麼來的 在一段邏輯裡面有new A 你就會和A這個class有耦合，要怎樣才能解耦合?<br>依賴其interface 這個我們叫做依賴反轉<br>改從參數傳進去  這個我們叫做控制反轉<br><a href="https://www.runoob.com/note/36434" target="_blank" rel="noopener">https://www.runoob.com/note/36434</a><br>[從被動變主動—依賴反轉]<a href="https://ithelp.ithome.com.tw/articles/10191603" target="_blank" rel="noopener">https://ithelp.ithome.com.tw/articles/10191603</a><br>[深入理解DIP、IoC、DI以及IoC容器] (<a href="http://www.uml.org.cn/sjms/201409021.asp" target="_blank" rel="noopener">http://www.uml.org.cn/sjms/201409021.asp</a>)<br><a href="https://gitee.com/obamajs/php-base-container/blob/master/Container.php" target="_blank" rel="noopener">容器範例</a></p>
<h2 id="CARP"><a href="#CARP" class="headerlink" title="CARP"></a>CARP</h2><p>合成/聚合復用原則（Composite/Aggregate Reuse Principle，CARP）經常又叫做合成復用原則。<br>儘量使用合成/聚合，儘量不要使用繼承。就是說要少用繼承，多用合成關係來實現，應儘量針對 Interface 編程，而非實現類<br>讓各個類儘可能少的跟別人聯繫，擴展性和維護性才能提高</p>
<h2 id="迪米特法則（Law-of-Demeter，LoD）"><a href="#迪米特法則（Law-of-Demeter，LoD）" class="headerlink" title="迪米特法則（Law of Demeter，LoD）"></a>迪米特法則（Law of Demeter，LoD）</h2><p>也稱為最少知識原則（Least Knowledge Principle，LKP）<br>一個對象應對其他對象有儘可能少的瞭解，對於你要呼叫的對象，或者耦合的對象不需要知道的太多<br>例子: 六度人脈空間<br>也就是說如果我想聯繫比爾蓋茲，我只要找到我與他之間的六個人，然後藉由這六個人的介紹，我就可以順利的聯繫到比爾蓋茲<br>參考:<a href="https://ithelp.ithome.com.tw/articles/10237285" target="_blank" rel="noopener">從生活中認識Design Pattern</a></p>
<h3 id="tell-don’t-ask"><a href="#tell-don’t-ask" class="headerlink" title="tell don’t ask"></a>tell don’t ask</h3><p>的面向对象编程是告诉对象你要做什么，而不是询问对象的状态后根据状态做行动</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2019/11/05/%E8%A8%AD%E8%A8%88%E6%A8%A1%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/05/%E8%A8%AD%E8%A8%88%E6%A8%A1%E5%BC%8F/" class="post-title-link" itemprop="url">設計模式</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2019-11-05 22:52:50" itemprop="dateCreated datePublished" datetime="2019-11-05T22:52:50+08:00">2019-11-05</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-04-20 07:58:27" itemprop="dateModified" datetime="2023-04-20T07:58:27+08:00">2023-04-20</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%BB%BB%E4%BD%95%E8%B7%AF%E7%B7%9A/" itemprop="url" rel="index"><span itemprop="name">任何路線</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%BB%BB%E4%BD%95%E8%B7%AF%E7%B7%9A/%E8%A8%AD%E8%A8%88%E5%8E%9F%E5%89%87/" itemprop="url" rel="index"><span itemprop="name">設計原則</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%BB%BB%E4%BD%95%E8%B7%AF%E7%B7%9A/%E8%A8%AD%E8%A8%88%E5%8E%9F%E5%89%87/%E8%A8%AD%E8%A8%88%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">設計模式</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%BB%BB%E4%BD%95%E8%B7%AF%E7%B7%9A/%E8%A8%AD%E8%A8%88%E5%8E%9F%E5%89%87/%E8%A8%AD%E8%A8%88%E6%A8%A1%E5%BC%8F/%E8%A8%AD%E8%A8%88%E8%A6%8F%E7%AF%84/" itemprop="url" rel="index"><span itemprop="name">設計規範</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="初衷"><a href="#初衷" class="headerlink" title="初衷"></a>初衷</h1><p>人最麻煩<br>有人說物件導向是大公司的陰謀論，扼殺掉發展更先進的程式語言的可能<br>你可以發現其實整個物件導向發展會讓你的 code 變得越來越複雜，但一切又是為了<strong>管理</strong>，人一多，我們變又開始遵循這 1970 年代留下來的模式<br>為了讓你工作多一點效率，所謂的效率是指</p>
<p><a href="https://www.ptt.cc/bbs/Soft_Job/M.1603008934.A.569.html" target="_blank" rel="noopener">https://www.ptt.cc/bbs/Soft_Job/M.1603008934.A.569.html</a></p>
<ol>
<li>降低維護成本<br>e.g.單元測試，unit test 就是規格的全部，來降低維護成本，可（易於）測試的代碼，一定是「低耦合」的)</li>
<li>降低開發成本<br>e.g.Functional programming</li>
</ol>
<p>為了達成以上的兩個目的，我們有許多方面需要思考</p>
<ol>
<li>資料方面<br>e.g. Avoid state, Using immutable data</li>
<li>架構方面<br>e.g. session的應用</li>
<li>程式方面</li>
<li>維運方面</li>
</ol>
<p>現實面:<br>維運成本和開發成本不可能兩個兼顧，你只能選個折衷方案，例如TDD可以降低維護成本，但你可能需要花2~3倍的時間(開發成本)來寫測試，市場千變萬化，你的專案能撐到那時候嗎??如果有信心，那TDD就值得投資<br>維護成本與效能也是成反比的，有效率的CODE 可讀性可能很差</p>
<p>Object oriented programming<br>那設計模式講的就是程式方面，我們遵守許多原則降低開發維護成本</p>
<ol>
<li>SOLID</li>
<li>Design Pattern<br>如果遇到必要的複雜設計 design pattern 可以降低溝通成本 (通常會增加維護成本)</li>
<li>Inheritance</li>
<li>Polymorphism</li>
<li>KISS</li>
<li>etc.</li>
</ol>
<p>目的:</p>
<ul>
<li>讓團隊可以 10 秒內看懂你的 code，讓你可以 10 秒內看懂別人的 code</li>
<li>讓你可以少寫一點 code</li>
</ul>
<p>然而莫忘初衷，不要為了用設計模式而用，不要走火入魔增加維運的難度<br>設計模式是藥，沒病就不要亂吃藥，藥是需要成本的</p>
<p>參考：比物件導向更先進的程式設計思想 by herrowui</p>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>重構的考量<br><a href="https://www.ptt.cc/bbs/Soft_Job/M.1645890217.A.B0F.html" target="_blank" rel="noopener">https://www.ptt.cc/bbs/Soft_Job/M.1645890217.A.B0F.html</a></p>
<p>各個語言對設計模式的詮釋不同，因為我是寫PHP的，所以看PHP的範例會比較容易了解<br><a href="https://github.com/DesignPatternsPHP/DesignPatternsPHP" target="_blank" rel="noopener">https://github.com/DesignPatternsPHP/DesignPatternsPHP</a><br><a href="https://learnku.com/docs/php-design-patterns/2018/php-design-pattern-reading-list/1525" target="_blank" rel="noopener">https://learnku.com/docs/php-design-patterns/2018/php-design-pattern-reading-list/1525</a><br><a href="https://laravelacademy.org/post/2680" target="_blank" rel="noopener">https://laravelacademy.org/post/2680</a></p>
<p>菜鳥教程列出場景和應用<br><a href="https://www.runoob.com/design-pattern/design-pattern-tutorial.html" target="_blank" rel="noopener">https://www.runoob.com/design-pattern/design-pattern-tutorial.html</a></p>
<p><a href="https://codesource.io/brief-overview-of-design-pattern-used-in-laravel/" target="_blank" rel="noopener">https://codesource.io/brief-overview-of-design-pattern-used-in-laravel/</a></p>
<p>软件设计模式：模式是在软件开发过程中总结得出的一些可重用的解决方案，它能解决一些实际的问题。一些常见的模式，比如工厂模式、单例模式等等。</p>
<p>設計模式有很多種場景，最知名的就是 gof 人幫的 23 种设计模式，那目前這些設計模式都是為了解決<strong>物件導向</strong>程式設計的場景<br>设计模式提供了一个标准的<strong>术语系统</strong>，且具体到特定的情景，當你提到這個名詞時，別人就知道你在說什麼</p>
<p>创建型模式(creattional patterns) ： 我們不管物件如何被實例，不管他背後的邏輯 共 5 种：工厂方法模式(factory)、抽象工厂模式、单例模式(singleton)、建造者模式(builder)、原型模式。<br>结构型模式(structural patterns)： 物件之間的關係（繼承？） 共 7 种：适配器模式(adapter)、装饰器模式(decorator)、代理模式(proxy)、外观模式(facade)、桥接模式、组合模式、享元模式。<br>行为型模式共(behavioural patterns) ：物件之間如何溝通 11 种：策略模式(stratege pattern)、模板方法模式、观察者模式、迭代子模式、责任链模式、命令模式、备忘录模式、状态模式、访问者模式、中介者模式、解释器模式。<br>當然後續還有許多設計模式一一誕生，<strong>不只這 23 種</strong><br>不要為了用而用設計模式，在某方面來說設計模式也許反應了語言不足之處</p>
<p><a href="https://medium.com/fcamels-notes/%E8%A8%AD%E8%A8%88%E6%A8%A1%E5%BC%8F%E5%85%B6%E5%AF%A6%E6%98%AF%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80%E7%9A%84%E7%BC%BA%E9%99%B7-ee45364783cf" target="_blank" rel="noopener">https://medium.com/fcamels-notes/%E8%A8%AD%E8%A8%88%E6%A8%A1%E5%BC%8F%E5%85%B6%E5%AF%A6%E6%98%AF%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80%E7%9A%84%E7%BC%BA%E9%99%B7-ee45364783cf</a></p>
<p>設計模式其實是程式語言的缺陷？<br>任何一種設計模式都有其應用的場景，那生在應用框架的年代，用這平凡的腦袋試著去理解常出現的場景，看看多久能理解完吧，可能努力一輩子都沒有別人學的好學得快，但就這樣慢慢來吧，看看子己能活到什程度</p>
<p><a href="https://github.com/flyingalex/design-patterns-by-php" target="_blank" rel="noopener">https://github.com/flyingalex/design-patterns-by-php</a></p>
<h1 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h1><h2 id="5大創建型"><a href="#5大創建型" class="headerlink" title="5大創建型"></a>5大創建型</h2><p>依照創建的方法，位置不同來做區別</p>
<h3 id="簡單工廠模式（Factory-Pattern）"><a href="#簡單工廠模式（Factory-Pattern）" class="headerlink" title="簡單工廠模式（Factory Pattern）"></a>簡單工廠模式（Factory Pattern）</h3><p>定義: 講一系列需要new個過程，用方法包起來，這個方法我們稱之為工廠</p>
<p>目的：讓創建同類的過程在工廠進行</p>
<p>優點:</p>
<ul>
<li>decouples code (解耦)</li>
<li>factory is responsible for creating objects , not the client</li>
<li>multiple client call the same factory , one place for changes</li>
<li>easier to test,easy to mock and isolate</li>
</ul>
<p>缺點：每次增加產品就需要增加類，類變多複雜度也變高，工廠也需要再加判斷邏輯</p>
<p>使用場景：數據庫切換只需要在工廠輸入 mysql 或 mssql，即可得到其object</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">Class</span> <span class="title">DbFactory</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">make</span><span class="params">($driver)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span>($driver)&#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'mysql'</span>:</span><br><span class="line">        $db = <span class="keyword">new</span> Mysql();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'mssql'</span>:</span><br><span class="line">        $db = <span class="keyword">new</span> Mssql();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">$driver = <span class="string">'mysql'</span>;</span><br><span class="line">$dbFactory = <span class="keyword">new</span> DbFactory();</span><br><span class="line">$db = $dbFactory-&gt;make(<span class="string">'mssql'</span>);</span><br></pre></td></tr></table></figure>

<h3 id="工廠方法模式"><a href="#工廠方法模式" class="headerlink" title="工廠方法模式"></a>工廠方法模式</h3><p>定義: 將工廠class抽象出一個interface，使同<strong>同產品</strong>依賴這interface，簡單來說就是將工廠分類</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">Interface</span> <span class="title">DbFactoryInterface</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">make</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MysqlFactory</span> <span class="keyword">implements</span> <span class="title">DbFactoryInterface</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">make</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MySql();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MssqlFactory</span> <span class="keyword">implements</span> <span class="title">DbFactoryInterface</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">make</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MsSql();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$driver = <span class="string">'mysql'</span>;</span><br><span class="line"><span class="keyword">switch</span>($driver)&#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'mysql'</span>:</span><br><span class="line">    $factory = <span class="keyword">new</span> MysqlFactory();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'mssql'</span>:</span><br><span class="line">    $factory = <span class="keyword">new</span> MssqlFactory();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">$db = $factory-&gt;make();</span><br></pre></td></tr></table></figure>

<h3 id="抽象工廠模式（Abstract-Factory-Pattern）"><a href="#抽象工廠模式（Abstract-Factory-Pattern）" class="headerlink" title="抽象工廠模式（Abstract Factory Pattern）"></a>抽象工廠模式（Abstract Factory Pattern）</h3><p>定義: 將工廠class抽象出一個interface，使同<strong>一系列產品</strong>依賴這interface，簡單來說就是將工廠分類</p>
<p>目的：抽象出工廠，讓創建工廠的的過程在 producer 進行，整個變成超大型工廠</p>
<p>優點：工廠模式優點，連工廠都納入</p>
<p>缺點：更複雜，增加新一類產品，要新增工廠，抽象類也要新增方法，producer 也要新增判斷，在加上工廠模式的缺點</p>
<p>場景: 你不知道使用者會用哪個資料庫</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">Interface</span> <span class="title">DbFactoryInterface</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">make</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OracleFactory</span> <span class="keyword">implements</span> <span class="title">DbFactoryInterface</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">makeDB</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MySql();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">makeCloud</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> OracleCloud();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MsFactory</span> <span class="keyword">implements</span> <span class="title">DbFactoryInterface</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">makeDB</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MsSql();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">makeCloud</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Azure();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$driver = <span class="string">'oracle'</span>;</span><br><span class="line"><span class="keyword">switch</span>($driver)&#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'oracle'</span>:</span><br><span class="line">    $factory = <span class="keyword">new</span> OracleFactory();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'ms'</span>:</span><br><span class="line">    $factory = <span class="keyword">new</span> MsFactory();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$db = $factory-&gt;makeDB();</span><br><span class="line">$cloud = $factory-&gt;makeCloud();</span><br></pre></td></tr></table></figure>

<h3 id="單例模式（Singleton-Pattern）"><a href="#單例模式（Singleton-Pattern）" class="headerlink" title="單例模式（Singleton Pattern）"></a>單例模式（Singleton Pattern）</h3><p>定義: 一個Class已經實例過一個物件時，再次new時，會回傳同一個物件，不再new新的</p>
<p>目的：確保整個生命週期該 class 只有<strong>一個實例被創建</strong>，並可以全局訪問該實例</p>
<p>需要：判斷實例是否存在即可</p>
<p>優點：省資源</p>
<p>缺點：不能被繼承，不能有 interface，因此違反 srp,一個類不該擔心外面是如何創建它的</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Db</span></span>&#123;</span><br><span class="line">  $instance = <span class="keyword">null</span></span><br><span class="line">  <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;instance===<span class="keyword">null</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">self</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;instance;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">$db = Db::getInstance();</span><br></pre></td></tr></table></figure>

<h3 id="建造者-生產者-模式（Builder-Manager-Pattern）"><a href="#建造者-生產者-模式（Builder-Manager-Pattern）" class="headerlink" title="建造者(生產者)模式（Builder(Manager) Pattern）"></a>建造者(生產者)模式（Builder(Manager) Pattern）</h3><p>定義: 將<strong>一系列方法</strong>抽成interface，每個factory實做這個interface，然後再用一個創建者的類按流程呼叫這<strong>一系列方法</strong>包起來，再回傳這個大物件，簡單來說就是將大物件的建造集合各個factory，流程再抽出一個class來管理</p>
<p>目的：將多個有<strong>一系列創建流程</strong>的 code 包在個別方法，然後再用一個創建者的類包起來，此時可以用同一個創建者類創建不同工廠的實體</p>
<p>優點：</p>
<ul>
<li>decouples code</li>
<li>focuses on building complex objects step by step and returns them</li>
<li>has functionality to decide which objects should be returned</li>
</ul>
<p>缺點：<br>需要搞懂 class 之間的關係，因為 new 的地點不統一，產品各有相依性，產品必須要有共通點，否則難以包裝，由於強型別的關係，很多簡單的事都要一層包過一層，像是要使用陣列就要同一型別，包裝不易</p>
<p>與抽象工廠模式的差別是，抽象工廠模式注重<strong>產品集中創建</strong>，建造者模式更<strong>注重流程</strong>，便於控制細節流程，適合屬性互相有流程依賴的 class，又多包了一層導演層</p>
<p>與外觀模式的不同點在於，創造者著重在創建物件流程包起來，可以簡單調用，外觀模式則是對統合所有CLASS，使其有一定的使用方法，使系統使用上更簡單</p>
<p>場景: 你不知道使用者會用哪個資料庫，但這一系列創造過程相似</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">Interface</span> <span class="title">DbFactoryInterface</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">doSomething</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">doOtherthing</span><span class="params">()</span></span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">make</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MysqlFactory</span> <span class="keyword">implements</span> <span class="title">DbFactoryInterface</span></span>&#123;</span><br><span class="line">  $myslq;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;mysql =  <span class="keyword">new</span> MySql();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;mysql;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">doOtherthing</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $mysql-&gt;setOtherthing();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;mysql;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">make</span><span class="params">()</span></span>&#123;</span><br><span class="line">    $mysql-&gt;setMorething();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;mysql;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DbBuilder</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">make</span><span class="params">(DbFactoryInterface $db)</span></span>&#123;</span><br><span class="line">    $db-&gt;doSomething();</span><br><span class="line">    $db-&gt;doOtherthing();</span><br><span class="line">    $db-&gt;make();</span><br><span class="line">    <span class="keyword">return</span> $db;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$dbBulder = <span class="keyword">new</span> DbBuilder();</span><br><span class="line"><span class="keyword">switch</span>($driver)&#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'mysql'</span>:</span><br><span class="line">    $db = $dbBulder-&gt;make(<span class="keyword">new</span> MysqlFactory());</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">'mssql'</span>:</span><br><span class="line">    $db = $dbBulder-&gt;make(<span class="keyword">new</span> MsSqlFactory());</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="原型模式（Prototype-Pattern）"><a href="#原型模式（Prototype-Pattern）" class="headerlink" title="原型模式（Prototype Pattern）"></a>原型模式（Prototype Pattern）</h3><p>目的：建一個可拷貝的類，其被實例之後，可以供人做拷貝<br>需要：</p>
<ul>
<li>語言有 cloneable interface</li>
</ul>
<p>優點：class 初使化消耗很多資源，採用拷貝的方式可以節省資源，當類建構子需要做很多動作時，也省資源，對一個物件要多人存取的場景也有用</p>
<p>缺點：需要對類的功能作多方面的考慮，對新 class 的沒問題，對已有的 class 有一定程度的</p>
<p>困難，要多實現 cloneable 的 interface</p>
<h2 id="7大結構型-N"><a href="#7大結構型-N" class="headerlink" title="7大結構型+N"></a>7大結構型+N</h2><h3 id="適配器模式-adpter-wrapper-Pattern"><a href="#適配器模式-adpter-wrapper-Pattern" class="headerlink" title="適配器模式(adpter (wrapper) Pattern)"></a>適配器模式(adpter (wrapper) Pattern)</h3><p>目的：作为A B两个不兼容的接口之间的桥梁，使得原本由于接口不兼容的类可以一起工作，生出一個 adapter 類</p>
<p>需要：額外多個adapter類，對A或B其中一個再包一層，例如實作了B interface裡面的function對進行A的方法調用</p>
<p>優點：1、可以让任何两个没有关联的类一起运行。 2、提高了类的复用。 3、增加了类的透明度。 4、灵活性好。</p>
<p>缺點：1、过多地使用适配器，会让系统非常零乱，不易整体进行把握。比如，明明看到调用的是 A 接口，其实内部被适配成了 B 接口的实现，如果不是很有必要，可以不使用适配器，而是直接对系统进行重构，例如橋接模式</p>
<h3 id="桥接（Bridge）"><a href="#桥接（Bridge）" class="headerlink" title="桥接（Bridge）"></a>桥接（Bridge）</h3><p>目的：因為避免後人繼承太多層，愈繼承愈發散，愈多層，解開需要繼承的耦合<br>例如: 預留參數注入物件的方式擴充功能，因為不能修改父類，這種父類一開始用interface來當作依賴，過考慮擴充的可能，我們稱為橋接<br>需要：</p>
<ul>
<li><p>產品細節功能系列的 interface 當作橋樑</p>
</li>
<li><p>產品的細節功能 class</p>
</li>
<li><p>抽象類注入實例化的產品的細節功能，把橋樑搭進來</p>
</li>
<li><p>繼承抽像類的產品 class，必須注入實例化後的產品細節功能，好處是這些功能和產品分開了<br>雖然沒有繼承，但我覺得可以看成是子類的注入</p>
<p>優點： 将类的功能层次结构和实现层次结构相分离，使二者能够独立地变化，并在两者之间搭建桥梁，实现桥接<br>缺点：桥接模式的引入会增加系统的理解与设计难度，由于聚合关联关系建立在抽象层，要求开发者针对抽象进行设计与编程</p>
</li>
</ul>
<p>後續我認為 trait 可以很好的解決這件事</p>
<p>跟adaper pattern很像，一樣是抽出一個interface,只是一個是在設計階段coding之前就抽出，一個是在coding之後來抽</p>
<h3 id="组合模式（Composite-Pattern）"><a href="#组合模式（Composite-Pattern）" class="headerlink" title="组合模式（Composite Pattern）"></a>组合模式（Composite Pattern）</h3><p>目的：把一组相似的对象当作一个单一的对象，解決树型结构的问题中，模糊了简单元素和复杂元素的概念<br>需要：單一個 class<br>優點：很好的實踐<strong>樹狀結構</strong><br>缺點：單一個類，實現多個層級身份，沒有用 interface 違反 dip</p>
<h3 id="装饰器模式（Decorator-Pattern）"><a href="#装饰器模式（Decorator-Pattern）" class="headerlink" title="装饰器模式（Decorator Pattern）"></a>装饰器模式（Decorator Pattern）</h3><p>在開放關閉原則下，你不修改原本的類，你能用的就只有繼承，但你又不想要繼承，裝飾器新增了一個額外的關係，可以讓你對原有的物件進行擴充，好處就是不會為了增加方法就一直繼承，繼承太多很可怕<br>我是認為如果有機會可以修改原本的CODE就改啦。<br>目的：向一个现有的对象添加新的功能，同时又不改变其结构，可以<strong>动态扩展</strong>一个实现类的功能<br>需要：</p>
<ul>
<li>系列產品的 interface</li>
<li>裝飾的抽象 class 實作系列產品的 interface，提供產品的注入</li>
<li>繼承裝飾抽象 class 的裝飾類，可實作擴充方法，須注入產品<br>雖然沒有繼承，但我覺得可以看成是父類的注入</li>
</ul>
<p>缺點：多层装饰比较复杂<br>可能會認為跟 trait 很像，不同點是這是動態擴充，想添加在添加就型，依賴不在要擴充的類之上<br><a href="https://segmentfault.com/a/1190000006919258" target="_blank" rel="noopener">https://segmentfault.com/a/1190000006919258</a><br><a href="https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/214999/" target="_blank" rel="noopener">https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/214999/</a></p>
<h3 id="外观模式（Facade-Pattern）"><a href="#外观模式（Facade-Pattern）" class="headerlink" title="外观模式（Facade Pattern）"></a>外观模式（Facade Pattern）</h3><p>目的：隐藏系统的复杂性，并向客户端提供了一个客户端可以访问系统的接口<br>需要：</p>
<ul>
<li><p>一個接待者的 class 創建所有依賴，不只是負責創建對象，也實現了所有所需的方法，<strong>整個包過一層</strong></p>
<p>优点： 1、减少系统相互依赖。 2、提高灵活性。 3、提高了安全性。<br>缺点：不符合 OCP，如果要改东西很麻烦，继承重写都不合适。<br>和代理模式的不同點在於，方法都不一樣了，整個簡化包過</p>
</li>
</ul>
<h3 id="享元模式（Flyweight-Pattern）"><a href="#享元模式（Flyweight-Pattern）" class="headerlink" title="享元模式（Flyweight Pattern）"></a>享元模式（Flyweight Pattern）</h3><p>目的：以减少内存占用和提高性能<br>需要：</p>
<ul>
<li><p>hash table 來存實例的物件</p>
</li>
<li><p>factory class 來分派實例後的物件<br>优点：大大减少对象的创建，降低系统的内存，使效率提高。<br>缺点：提高了系统的复杂度，需要分离出外部状态和内部状态。要封裝好，不能讓物件輕易受影響<br>與 clone 不同，是回傳同一個物件</p>
<p>與單例模式的不同點在於，單例减少创建对象的数量，但享元操作更細緻，就是他不限制你主物件創建的數量，但是你底下屬性的物件會限制你，真的就是享<strong>元</strong>，讓你一個class就要拆出會與其他class共用的屬性出來</p>
</li>
</ul>
<h3 id="代理模式（Proxy-Pattern）"><a href="#代理模式（Proxy-Pattern）" class="headerlink" title="代理模式（Proxy Pattern）"></a>代理模式（Proxy Pattern）</h3><p>目的：有些对象由于某些原因（比如对象创建开销很大，或者某些操作需要安全控制，或者需要进程外的访问），所以创建具有现有对象的对象，以便向外界提供功能接，也就是說我們可能要對某段邏輯做額外的處理，此時不修改現有的function，多一個代理function來做處理，不需要代理時，代理function丟掉也沒關係，因為接口一樣<br>  需要： </p>
<ul>
<li>interface</li>
<li>一個代理的 class，裡面創建真正產品的類再調用<br>优点： 1、职责清晰。 2、高扩展性。 3、智能化。<br>缺点： 1、可能会造成请求的处理速度变慢。 2、实现代理模式需要额外的工作，有些代理模式的实现非常复杂。</li>
</ul>
<h3 id="过滤器模式（Filter-Pattern）或标准模式（Criteria-Pattern）"><a href="#过滤器模式（Filter-Pattern）或标准模式（Criteria-Pattern）" class="headerlink" title="过滤器模式（Filter Pattern）或标准模式（Criteria Pattern）"></a>过滤器模式（Filter Pattern）或标准模式（Criteria Pattern）</h3><p>不隸屬23種</p>
<p>目的：一系列的過濾方法，來達成過濾的邏輯，通过<strong>逻辑运算</strong>以解耦的方式把它们连接起来，结合多个标准来获得单一标准<br>需要：</p>
<ul>
<li>標準的 interface</li>
<li>各個標準的 class</li>
<li>產品的 class 內含各個標準所需要過濾的屬性</li>
</ul>
<p>實際情況:<br>現實生活中，我們總是運用sql語句來查詢，加上一些and or 來組成sql語句，那如果有天sql語句失效，需要你組合出<strong>特定條件的資料</strong>，此時就派得上了</p>
<h3 id="流接口模式（Fluent-Interface）"><a href="#流接口模式（Fluent-Interface）" class="headerlink" title="流接口模式（Fluent Interface）"></a>流接口模式（Fluent Interface）</h3><p>不隸屬23種</p>
<p>目的：是指实现一种面向对象的、能提高代码可读性的 API 的方法，其目的就是可以编写具有自然语言一样可读性的代码<br>舉例：laravel 的  querybuilder就像是這樣，你可以用select()、where()來組出sql語句</p>
<h3 id="注册模式（Registry）"><a href="#注册模式（Registry）" class="headerlink" title="注册模式（Registry）"></a>注册模式（Registry）</h3><p>不隸屬23種</p>
<p>目的：注册模式（Registry）也叫做注册树模式，注册器模式。注册模式为应用中经常使用的对象创建一个中央存储器来存放这些对象 —— 通常通过一个只包含静态方法的抽象类来实现（或者通过单例模式）。<br>舉例：我認為falcon框架的容器就是這個模式的演化</p>
<h2 id="11-1大行為型"><a href="#11-1大行為型" class="headerlink" title="11+1大行為型"></a>11+1大行為型</h2><p>資料的流程控制場景,有些場景會很少用</p>
<h3 id="責任鏈模式（Chain-of-Responsibility-Pattern）"><a href="#責任鏈模式（Chain-of-Responsibility-Pattern）" class="headerlink" title="責任鏈模式（Chain of Responsibility Pattern）"></a>責任鏈模式（Chain of Responsibility Pattern）</h3><p>目的：避免请求发送者与接收者耦合在一起，让多个对象都有可能接收请求<br>需要：</p>
<ul>
<li>一個接受者的抽象 class,裡面要設定下一個接收者</li>
<li>各個接收者的 class</li>
<li>在使用的 demo 裡面 new 各種接收者，並設定下個接收者<br>優點：發送者只需要知道职责链上即可，无须关心请求的处理细节和请求的传递<br>缺点： 1、不能保证请求一定被接收。 2、系统性能将受到一定影响，而且在进行代码调试时不太方便，可能会造成循环调用。 3、可能不容易观察运行时的特征，有碍于除错。<br>舉例:面試流程(一面二面三面)，filter<br>變體:pipeline設計模式(管道模式，流水線模式)<br>與創造者模式的差別在於，創造者著也是對流程做包裝，但是無法有效地把流程做無痛的抽換，且流水線的流程通常比較大，創造者的流程比較小</li>
</ul>
<h3 id="命令模式（Command-Pattern）"><a href="#命令模式（Command-Pattern）" class="headerlink" title="命令模式（Command Pattern）"></a>命令模式（Command Pattern）</h3><p>目的：有點像是事件觸發和綁定的處理<br>需要：</p>
<ul>
<li>一個發送者的 class，定義觸發的事件</li>
<li>個別事件用 class 包裝成命令，會注入事件的 class</li>
<li>一系列命令的 interface</li>
<li>處理命令的 class<br>最後執行事件的由處理命令的 class</li>
</ul>
<p>优点： 1、降低了系统耦合度。 2、新的命令可以很容易添加到系统中去。<br>缺点：使用命令模式可能会导致某些系统有过多的具体命令类。</p>
<h3 id="解释器模式（Interpreter-Pattern）"><a href="#解释器模式（Interpreter-Pattern）" class="headerlink" title="解释器模式（Interpreter Pattern）"></a>解释器模式（Interpreter Pattern）</h3><p>应用实例：编译器、运算表达式计算。</p>
<h3 id="迭代器模式（Iterator-Pattern）"><a href="#迭代器模式（Iterator-Pattern）" class="headerlink" title="迭代器模式（Iterator Pattern）"></a>迭代器模式（Iterator Pattern）</h3><p>意图：提供一种方法顺序访问一个聚合对象中各个元素, 而又无须暴露该对象的内部表示。</p>
<h3 id="策略模式（Strategy-Pattern）"><a href="#策略模式（Strategy-Pattern）" class="headerlink" title="策略模式（Strategy Pattern）"></a>策略模式（Strategy Pattern）</h3><p>目的： 不管策略為何怎麼換，達到的目的是一樣的即可(此模式符合開閉原則，我們就不改 interface 了，所以要確定好，所有的策略都從這裡來)，可以說用 interface 定義的都可被叫做策略模式，簡單來說就是把商業邏輯拆到個別class<br>目的:</p>
<ol>
<li>避免ifelse太長</li>
<li>負責控管的程式碼職責要分開，他只負責分配策略</li>
</ol>
<p>需要:</p>
<ol>
<li>拆分邏輯和管理分配中心的function或class</li>
<li>減少if/else/switch的使用</li>
<li>以維護的角度來看，分配中心是需要的，不然難以統整Code<ul>
<li>definde a familiy of algorithms thata are interchangeable</li>
<li>program to an interface , not an implementation</li>
</ul>
</li>
</ol>
<h3 id="中介者模式（Mediator-Pattern）"><a href="#中介者模式（Mediator-Pattern）" class="headerlink" title="中介者模式（Mediator Pattern）"></a>中介者模式（Mediator Pattern）</h3><p>目的：用一个中介对象来封装一系列的对象交互<br>优点： 1、降低了类的复杂度，将一对多转化成了一对一。 2、各个类之间的解耦。 3、符合迪米特原则。<br>缺点：中介者会庞大，变得复杂难以维护。<br>例子: MVC裡面的controller</p>
<h3 id="观察者模式（Observer-Pattern）"><a href="#观察者模式（Observer-Pattern）" class="headerlink" title="观察者模式（Observer Pattern）"></a>观察者模式（Observer Pattern）</h3><p>觀察者模式像是callback應用<br>發布訂閱模式<br>我認為是高級的callback應用，有個管理中心管理這些事件的handler，定义对象间一种一对多的依赖关系</p>
<h3 id="状态模式（State-Pattern）"><a href="#状态模式（State-Pattern）" class="headerlink" title="状态模式（State Pattern）"></a>状态模式（State Pattern）</h3><p>所有可能状态新建一个类， 然后将所有状态的对应行为抽取到这些类中<br>看上去与策略模式相似， 但有一个关键性的不同——在状态模式中， 特定状态知道其他所有状态的存在， 且能触发从一个状态到另一个状态的转换； 策略则几乎完全不知道其他策略的存在。就是這些狀態彼此有耦合。<br>目的: 減少if else底下複雜的程式碼</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>($isAdmin)&#123;</span><br><span class="line">  $document.changeState(<span class="keyword">new</span> Opened());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="模板模式（Template-Pattern）"><a href="#模板模式（Template-Pattern）" class="headerlink" title="模板模式（Template Pattern）"></a>模板模式（Template Pattern）</h3><p>需要: 父class調用子class的方法</p>
<h3 id="访问者模式（Visitor-Pattern）"><a href="#访问者模式（Visitor-Pattern）" class="headerlink" title="访问者模式（Visitor Pattern）"></a>访问者模式（Visitor Pattern）</h3><p>與裝飾器模式的不同點在於，裝飾器模式是擴展物件，完全不去動原本的Class，訪問者模式會需要擴展原本的class,加上accept方法，然後再去呼叫額外class裡面的方法，將this當作參數傳進去</p>
<p><a href="https://refactoringguru.cn/design-patterns/visitor" target="_blank" rel="noopener">https://refactoringguru.cn/design-patterns/visitor</a></p>
<h3 id="备忘录模式（Memento-Pattern）"><a href="#备忘录模式（Memento-Pattern）" class="headerlink" title="备忘录模式（Memento Pattern）"></a>备忘录模式（Memento Pattern）</h3><p>当你需要创建对象状态快照来恢复其之前的状态时， 可以使用备忘录模式。<br>編輯器的還原，資料庫的transation</p>
<h3 id="空对象模式（Null-Object-Pattern）"><a href="#空对象模式（Null-Object-Pattern）" class="headerlink" title="空对象模式（Null Object Pattern）"></a>空对象模式（Null Object Pattern）</h3><p>不隸屬23種<br>使用 Null Object 模式將符合 Tell, don’t Ask 原則<br><a href="https://www.muzilong.cn/storage/html/16/oomusou.io/dp/dp-nullobject/index.html" target="_blank" rel="noopener">https://www.muzilong.cn/storage/html/16/oomusou.io/dp/dp-nullobject/index.html</a></p>
<h2 id="J2EE型"><a href="#J2EE型" class="headerlink" title="J2EE型"></a>J2EE型</h2><h3 id="MVC-模式（MVC-Pattern）"><a href="#MVC-模式（MVC-Pattern）" class="headerlink" title="MVC 模式（MVC Pattern）"></a>MVC 模式（MVC Pattern）</h3><h3 id="业务代表模式（Business-Delegate-Pattern）"><a href="#业务代表模式（Business-Delegate-Pattern）" class="headerlink" title="业务代表模式（Business Delegate Pattern）"></a>业务代表模式（Business Delegate Pattern）</h3><h3 id="组合实体模式（Composite-Entity-Pattern）"><a href="#组合实体模式（Composite-Entity-Pattern）" class="headerlink" title="组合实体模式（Composite Entity Pattern）"></a>组合实体模式（Composite Entity Pattern）</h3><h3 id="数据访问对象模式（Data-Access-Object-Pattern）"><a href="#数据访问对象模式（Data-Access-Object-Pattern）" class="headerlink" title="数据访问对象模式（Data Access Object Pattern）"></a>数据访问对象模式（Data Access Object Pattern）</h3><h3 id="前端控制器模式（Front-Controller-Pattern）"><a href="#前端控制器模式（Front-Controller-Pattern）" class="headerlink" title="前端控制器模式（Front Controller Pattern）"></a>前端控制器模式（Front Controller Pattern）</h3><h3 id="拦截过滤器模式（Intercepting-Filter-Pattern）"><a href="#拦截过滤器模式（Intercepting-Filter-Pattern）" class="headerlink" title="拦截过滤器模式（Intercepting Filter Pattern）"></a>拦截过滤器模式（Intercepting Filter Pattern）</h3><h3 id="服务定位器模式（Service-Locator-Pattern）"><a href="#服务定位器模式（Service-Locator-Pattern）" class="headerlink" title="服务定位器模式（Service Locator Pattern）"></a>服务定位器模式（Service Locator Pattern）</h3><h3 id="传输对象模式（Transfer-Object-Pattern）"><a href="#传输对象模式（Transfer-Object-Pattern）" class="headerlink" title="传输对象模式（Transfer Object Pattern）"></a>传输对象模式（Transfer Object Pattern）</h3><h1 id="未歸類"><a href="#未歸類" class="headerlink" title="未歸類"></a>未歸類</h1><h3 id="provider-pattern"><a href="#provider-pattern" class="headerlink" title="provider pattern"></a>provider pattern</h3><p>目的： 整合所有的服務進容器 (符合 tell don’t ask principle)</p>
<h3 id="服务定位器模式-Service-Locator-Pattern"><a href="#服务定位器模式-Service-Locator-Pattern" class="headerlink" title="服务定位器模式 Service Locator Pattern"></a>服务定位器模式 Service Locator Pattern</h3><p>下面的例子是falcon框架的服務定位器，達成了依賴注入，為什麼拿這個當例子，因為laravel和yii的都是運用反射的依賴注入，比較自動化，比較高級，但太複雜<br><a href="http://docs.iphalcon.cn/reference/di-explained.html" target="_blank" rel="noopener">http://docs.iphalcon.cn/reference/di-explained.html</a></p>
<h3 id="Null-Object-模式"><a href="#Null-Object-模式" class="headerlink" title="Null Object 模式"></a>Null Object 模式</h3><p>什麼時候會用到這個呢?<br>當你總是有條件要判斷某個值是否存在，如果存在接下來do something，此時就可以把此條件抽出來，設置一個預設的NULL TYPE 的物件，那如果使用者沒選擇值，那預設就是 new 這個NULL的CLASS，當然這個NEW出來的NULL OBJECT裡面實作的方法，被替換之後也可以正常執行。</p>
<h3 id="IoC-—-Inversion-of-Control，控制反轉，一种反转流、依赖和接口的方式（DIP的具体实现方式）"><a href="#IoC-—-Inversion-of-Control，控制反轉，一种反转流、依赖和接口的方式（DIP的具体实现方式）" class="headerlink" title="IoC — Inversion of Control，控制反轉，一种反转流、依赖和接口的方式（DIP的具体实现方式）"></a>IoC — Inversion of Control，控制反轉，一种反转流、依赖和接口的方式（DIP的具体实现方式）</h3><p>IoC则是一种 软件设计模式，它告诉你应该如何做，来解除相互依赖模块的耦合。<br><a href="https://notfalse.net/3/ioc-di" target="_blank" rel="noopener">https://notfalse.net/3/ioc-di</a><br>目的:<br>系统更柔韧：可以修改一部分代码而不影响其他模块。</p>
<p>系统更健壮：可以修改一部分代码而不会让系统崩溃。</p>
<p>系统更高效：组件松耦合，且可复用，提高开发效率。</p>
<p>需要:<br>控制反转（IoC），它为相互依赖的组件提供抽象，将依赖（低层模块）对象的获得交给第三方（系统）来控制，即依赖对象不在被依赖模块的类中直接通过new来获取。<br>IoC 提倡者，給予其實作方式一個更具體的名稱</p>
<p>IoC有2种常见的实现方式：依赖注入和服务定位。</p>
<p>由此衍生出一種設計模式叫做依賴注入<br>— — “Dependency Injection (依賴注入)”。<br><a href="https://notfalse.net/3/ioc-di" target="_blank" rel="noopener">https://notfalse.net/3/ioc-di</a></p>
<p>所谓的依赖注入，举个例子，假如我需要依赖 db 的实例，我不要在自己的类裡面 new 一个 db，而是物件用传参数的方式传进来，那就可以分為<br><a href="https://learnku.com/laravel/t/26721" target="_blank" rel="noopener">https://learnku.com/laravel/t/26721</a><br>依賴注入是個花俏的名詞，事實上是指：類別的依賴透過建構子「注入」，或在某些情況下透過「setter」方法注入。大致分為列三种<br>构造方法注入<br>Setter 方法注入<br>接口注入<br>php 回調注入<br>那不就是传一个物件当参数尔以？？為何说的那么高级<br>因為通常让容器帮你 new 一个物件,所以高级<br>搭配容器才会有高级感<br>php 如何实现基本的容器操作<br><a href="https://learnku.com/articles/37162" target="_blank" rel="noopener">https://learnku.com/articles/37162</a><br>容器的实现是借由语言提供的反射来达成，就是可以注册一个东西，当我需要实例一个物件，这个类 a 对其他类 b 有依赖，只要这些其他类 b 有在容器注册过，<br>我要实例 a，只要用 container 提供的方式来 make 物件，a 类也设计成可以备注入的方式，就可以不用管 b 类实例需要蛇鬼参数，因為已经在容器注册过了，直接简单实例化 a</p>
<p>依照 class 之間依賴，new 的地方不同，實作的界面不同來達成，做結構上的調整,應付不同的情境</p>
<h3 id="軟體分層設計模式-Software-Layered-Architecture-Pattern"><a href="#軟體分層設計模式-Software-Layered-Architecture-Pattern" class="headerlink" title="軟體分層設計模式 (Software Layered Architecture Pattern)"></a>軟體分層設計模式 (Software Layered Architecture Pattern)</h3><h3 id="簡單工廠模式-Simple-Factory-Pattern-Static-Factory-Method"><a href="#簡單工廠模式-Simple-Factory-Pattern-Static-Factory-Method" class="headerlink" title="簡單工廠模式 (Simple Factory Pattern)(Static Factory Method)"></a>簡單工廠模式 (Simple Factory Pattern)(Static Factory Method)</h3><h3 id="Respository-模式-Respository-Pattern"><a href="#Respository-模式-Respository-Pattern" class="headerlink" title="Respository 模式 (Respository Pattern)"></a>Respository 模式 (Respository Pattern)</h3><h3 id="雙重檢查鎖定模式-Double-Checked-Locking-Pattern"><a href="#雙重檢查鎖定模式-Double-Checked-Locking-Pattern" class="headerlink" title="雙重檢查鎖定模式 (Double-Checked Locking Pattern)"></a>雙重檢查鎖定模式 (Double-Checked Locking Pattern)</h3>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2019/11/04/laravel%E4%BD%BF%E7%94%A8artisan/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/04/laravel%E4%BD%BF%E7%94%A8artisan/" class="post-title-link" itemprop="url">laravel使用artisan</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2019-11-04 20:30:13" itemprop="dateCreated datePublished" datetime="2019-11-04T20:30:13+08:00">2019-11-04</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2021-07-30 18:13:56" itemprop="dateModified" datetime="2021-07-30T18:13:56+08:00">2021-07-30</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/" itemprop="url" rel="index"><span itemprop="name">後端路線</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/framework/" itemprop="url" rel="index"><span itemprop="name">framework</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/framework/laravel/" itemprop="url" rel="index"><span itemprop="name">laravel</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="介紹"><a href="#介紹" class="headerlink" title="介紹"></a>介紹</h1><p>artisan 是 laravel 的 cli 工具，這種框架自帶的工具，在中國那邊都稱作腳手架，整個專案製作過程都離不開它，我們會用它來建 model、建 controller<br>諸如:</p>
<p>網站進入維修</p>
<pre><code>php artisan down</code></pre><p>本機啟動 server</p>
<pre><code>php artisan serve 類似於php -S localhost:8000</code></pre><p>建 controller</p>
<pre><code>php artisan make:controller Admin/AdminController</code></pre><p>要看<strong>所有指令</strong></p>
<pre><code>php artisan help</code></pre><p>目前是把常用的另列出來，之後再一一分開來筆記</p>
<h1 id="常用指令"><a href="#常用指令" class="headerlink" title="常用指令"></a>常用指令</h1><h2 id="資料庫遷移"><a href="#資料庫遷移" class="headerlink" title="資料庫遷移"></a>資料庫遷移</h2><p>用在專案初始化時</p>
<pre><code>php artisan migrate</code></pre><p>下這個指令之後，就可以將<code>database\migrations</code>裡面 laravel 預設的三張表新增到資料庫<br>遭遇狀況:</p>
<pre><code>PDOException::(&quot;SQLSTATE[42000]: Syntax error or access violation: 1071 Specified key was too long; max key length is 767 bytes&quot;)</code></pre><p>解決辦法:(<a href="https://laravel-news.com/laravel-5-4-key-too-long-error" target="_blank" rel="noopener">https://laravel-news.com/laravel-5-4-key-too-long-error</a>)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/Providers/AppServiceProvider.php</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">boot</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Schema::defaultStringLength(<span class="number">191</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>或是改<code>config\database.php</code>裡面的字符集</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'mysql'</span> =&gt; [</span><br><span class="line">    <span class="string">'charset'</span> =&gt; <span class="string">'utf8'</span>,</span><br><span class="line">    <span class="string">'collation'</span> =&gt; <span class="string">'utf8_unicode_ci'</span>,</span><br><span class="line">],</span><br></pre></td></tr></table></figure>

<p>然後要刪掉 migration 檔案之前，要先做一次<br>php artisan migration:reset<br>把 DB 的 migration 資料表清空不然就會遭遇<br>Migration not found: 2020_03_04_064053_create_user_power_table<br>此時就要去資料庫排刪掉這一行來排錯<br><a href="https://github.com/laravel/framework/issues/2105#issuecomment-22701759" target="_blank" rel="noopener">https://github.com/laravel/framework/issues/2105#issuecomment-22701759</a><br>If you deleted the file you should delete the matching row from the migrations table in your DB. Don’t delete a migration without doing migrate:reset first.</p>
<h2 id="建立資料表"><a href="#建立資料表" class="headerlink" title="建立資料表"></a>建立資料表</h2><p>將 Admin 表新增到<code>database\migrations</code>裡面</p>
<pre><code>php artisan make:migration admin</code></pre><p>或者新增一個 model 加參數-m，推薦這個，會幫忙建 migration，並且有表格基礎欄位<br>或者新增一個 model 加參數-a，會幫忙建 migrantion controller factory<br>那麼在以前 4.X 的 laravel 版本呢，我們會有個 model 資料夾，現在沒有了，原因是因為不想混淆使用者，詳情請看<a href="http://blog.turn.tw/?p=1541" target="_blank" rel="noopener">框架不應該有「MODELS」資料夾</a></p>
<pre><code>php artisan make:model Model/Admin -a</code></pre><p>然後一樣</p>
<pre><code>php artisan migrate</code></pre><p>就會幫忙建表進去了，已經有的表就不會重複建</p>
<p>剩下看文檔(<a href="https://laravel.tw/docs/5.2/migrations" target="_blank" rel="noopener">https://laravel.tw/docs/5.2/migrations</a>)</p>
<h2 id="塞假資料"><a href="#塞假資料" class="headerlink" title="塞假資料"></a>塞假資料</h2><p>阿如果要塞假資料，記得將該 model 的假資料規則加進<code>database\factories\AdminFactory</code>，就可以用工廠批量生產資料，用來測試用</p>
<pre><code>php artisan make:factory AdminFactory</code></pre><p>我們可以怎麼做呢?</p>
<ol>
<li><p>手動打指令<br>使用 tinker 來打 php 程式碼，tinker 就會執行，說是一種 read-eval-print-loop<br>要確定在建完 factory 之後在打開此命令行，不然會找不到</p>
<pre><code>Class &apos;App/Model/Admin&apos; not found in /var/www/html/lighthouse-tutorial/vendor/laravel/framework/src/Illuminate/Database/Eloquent/FactoryBuilder.php on

php artisan tinker 類似於 php --interactive php -a</code></pre><p>接著打上 php 的 code，可以操作資料庫，立即看到結果，不用在那邊<strong>var_dump</strong>，阿如果要塞假資料，記得將該 model 的假資料規則加進<code>database\factories</code>，之後就可以用</p>
</li>
</ol>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//看看多少使用者</span></span><br><span class="line">App\User::count();</span><br><span class="line"><span class="comment">//新增使用者</span></span><br><span class="line">factory(<span class="string">'App\User'</span>,<span class="number">10</span>)-&gt;create();</span><br><span class="line"><span class="comment">//打印</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>用 seeder<br>seeder 可以個別或引入工廠的方法來塞假資料，跟上面不同的是，以個是重新手打，一個記在程式碼後執行一次執行，有什麼好處呢?因為資料庫總是有一些要初始化的資料，例如標籤阿、管理員等</p>
<pre><code>php artisan make:seeder AdminTableSeeder</code></pre></li>
</ol>
<p>個別塞</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DB::table(<span class="string">'admin'</span>)-&gt;insert([</span><br><span class="line">        <span class="string">'name'</span> =&gt; str_random(<span class="number">10</span>),</span><br><span class="line">        <span class="string">'email'</span> =&gt; str_random(<span class="number">10</span>).<span class="string">'@gmail.com'</span>,</span><br><span class="line">        <span class="string">'password'</span> =&gt; bcrypt(<span class="string">'secret'</span>),</span><br><span class="line">    ]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>工廠批量塞，這邊要注意文章和使用者是有關連性的，一定要有使用者才會有文章</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//AdminTableSeeder</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    factory(App\User::class, <span class="number">10</span>)-&gt;create()-&gt;each(<span class="function"><span class="keyword">function</span><span class="params">($u)</span> </span>&#123;</span><br><span class="line">        $u-&gt;posts()-&gt;save(factory(App\Post::class)-&gt;make());</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//PostFactory</span></span><br><span class="line">$factory-&gt;define(Post::class, <span class="function"><span class="keyword">function</span> <span class="params">(Faker $faker)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        <span class="string">'user_id'</span> =&gt; factory(User::class)-&gt;create()-&gt;id,</span><br><span class="line">        <span class="string">'title'</span> =&gt; $faker-&gt;sentence,</span><br><span class="line">        <span class="string">'content'</span> =&gt; $faker-&gt;text</span><br><span class="line">    ];</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//DatabaseSeeder</span></span><br><span class="line"><span class="keyword">$this</span>-&gt;call(AdminTableSeeder::class);</span><br></pre></td></tr></table></figure>

<p>執行<br>php artisan db:seed –class=AdminsTableSeeder<br>或<br>php artisan db:seed</p>
<h2 id="初始化會員系統"><a href="#初始化會員系統" class="headerlink" title="初始化會員系統"></a>初始化會員系統</h2><p>laravel 內建一個會員系統，可能是因為太普遍，所以他直接幫你內建一個</p>
<pre><code>php artisan make:auth</code></pre><p>下完指令之後，內建的會員相關檔案都會建好，484 很方便呢<br><img src="/images/%E6%9C%83%E5%93%A1%E7%99%BB%E5%85%A5%E7%95%AB%E9%9D%A2.png" alt="會員登入畫面"></p>
<p>laravel 在 6.0 之後把這功能抽出來</p>
<pre><code>composer require laravel/ui
php artisan ui vue --auth</code></pre><p>執行之後的效果是一樣的</p>
<h2 id="自製指令"><a href="#自製指令" class="headerlink" title="自製指令"></a>自製指令</h2><pre><code>php artisan help make:command
php artisan make:command AddCompanyCommand</code></pre><p>接著在<code>app\Console\Commands\AddCompanyCommand.php</code>修改</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加上?代表該參數可選</span></span><br><span class="line"><span class="comment">// protected $signature = 'contact:&#123;name&#125; &#123;phone?&#125;';</span></span><br><span class="line"><span class="comment">// protected $signature = 'contact:&#123;name&#125; &#123;phone=N/A&#125;';</span></span><br><span class="line"><span class="keyword">protected</span> $signature = <span class="string">'contact:conpany'</span>;</span><br><span class="line"><span class="keyword">protected</span> $description = <span class="string">'add new company'</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $name = <span class="keyword">$this</span>-&gt;ask(<span class="string">'What is the company name?'</span>);</span><br><span class="line">    $phone = <span class="keyword">$this</span>-&gt;ask(<span class="string">'What is the company\'s phone number?'</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;confirm(<span class="string">'Are you ready to insert "'</span> . $name . <span class="string">'"?'</span>)) &#123;</span><br><span class="line">        $company = Company::create([</span><br><span class="line">            <span class="string">'name'</span> =&gt; $name,</span><br><span class="line">            <span class="comment">// 'phone' =&gt;$this-&gt;argument('name') ?? 'N/A';</span></span><br><span class="line">            <span class="string">'phone'</span> =&gt; $phone,</span><br><span class="line">        ]);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;info(<span class="string">'Added: '</span> . $company-&gt;name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;warn(<span class="string">'No new company was added.'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下 artisan 指令之後就會發現新的 command 出現在列表了<br>php artisan</p>
<p>contact<br>contact:company add new company</p>
<h2 id="簡單指令"><a href="#簡單指令" class="headerlink" title="簡單指令"></a>簡單指令</h2><p><code>routes\console.php</code>用於簡單的指令，盡量不要超過 10 行，最多就像下面的範例</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Artisan::command(<span class="string">'contact:company-clean'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;info(<span class="string">'Cleaning!'</span>);</span><br><span class="line">    Company::whereDoesntHave(<span class="string">'customers'</span>)</span><br><span class="line">        -&gt;get()</span><br><span class="line">        -&gt;each(<span class="function"><span class="keyword">function</span> <span class="params">($company)</span> </span>&#123;</span><br><span class="line">            $company-&gt;delete();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;warn(<span class="string">'Deleted: '</span> . $company-&gt;name);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;)-&gt;describe(<span class="string">'Cleans Up Unused Companies'</span>);</span><br></pre></td></tr></table></figure>

<h2 id="符號連結-Symbolic-link-指令"><a href="#符號連結-Symbolic-link-指令" class="headerlink" title="符號連結 (Symbolic link)指令"></a>符號連結 (Symbolic link)指令</h2><p>會將/storage/app/public 和/public/storage 做連結，<br>切忌路徑就這這兩個，如果要連接其他的路徑，請去網路上找連結的指令<br>php artisan storage:link</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left" aria-label="上一頁"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Stanley Ke</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  















  








  

  

</body>
</html>
