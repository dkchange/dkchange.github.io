<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"dkchange.github.io","root":"/","scheme":"Gemini","version":"8.0.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜尋...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="蛋粒個人網誌">
<meta property="og:url" content="http:&#x2F;&#x2F;dkchange.github.io&#x2F;page&#x2F;3&#x2F;index.html">
<meta property="og:site_name" content="蛋粒個人網誌">
<meta property="og:locale" content="zh-TW">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://dkchange.github.io/page/3/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-TW'
  };
</script>

  <title>蛋粒個人網誌</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">蛋粒個人網誌</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Stanley Ke</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">78</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">44</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/dkchange" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;dkchange" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">
      

      
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2020/10/05/laravel%E9%80%B2%E9%9A%8E%E5%8A%9F%E8%83%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/05/laravel%E9%80%B2%E9%9A%8E%E5%8A%9F%E8%83%BD/" class="post-title-link" itemprop="url">laravel進階功能</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-10-05 11:02:05" itemprop="dateCreated datePublished" datetime="2020-10-05T11:02:05+08:00">2020-10-05</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2022-06-10 08:10:17" itemprop="dateModified" datetime="2022-06-10T08:10:17+08:00">2022-06-10</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/" itemprop="url" rel="index"><span itemprop="name">後端路線</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/framework/" itemprop="url" rel="index"><span itemprop="name">framework</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BE%8C%E7%AB%AF%E8%B7%AF%E7%B7%9A/framework/laravel/" itemprop="url" rel="index"><span itemprop="name">laravel</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="symfony"><a href="#symfony" class="headerlink" title="symfony"></a>symfony</h1><p>一個開源的框架，因為致力於做出PHP比較底層的原件，所以很多php框架都底層都用他，laravel也不例外，其中尤其重要的是<br>http-kernel這個元件</p>
<h1 id="生命週期"><a href="#生命週期" class="headerlink" title="生命週期"></a>生命週期</h1><p><a href="https://learnku.com/articles/54613" target="_blank" rel="noopener">Laravel 執行原理分析與原始碼分析,底層看這篇足矣</a></p>
<h1 id="Service-Container"><a href="#Service-Container" class="headerlink" title="Service Container"></a>Service Container</h1><p>laravel 服務容器管理 class 的依賴關係的一種方式，例如 route model binding，讓你可以依賴注入，<br>好處是當你的建構子需要改東西時，你不用在個別有 new 他的地方改 code，你只需要改一個地方</p>
<p><a href="https://laracasts.com/series/laravel-6-from-scratch/episodes/39?autoplay=true" target="_blank" rel="noopener">https://laracasts.com/series/laravel-6-from-scratch/episodes/39?autoplay=true</a></p>
<p>那由於 laravel 最自動幫你找命名空間下的 class,有的話他就會幫你注入，你不必自己去綁定進 app 這個 container，但是如果你是個 interface，laravel 就不能幫你實體化了</p>
<p>在 AppServiceProvider</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;app-&gt;bind(PaymentGateway::class,<span class="function"><span class="keyword">function</span><span class="params">($app)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> PaymentGateway(<span class="string">'usd'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="View-Composer"><a href="#View-Composer" class="headerlink" title="View Composer"></a>View Composer</h1><p>解決的痛點是，如果各個 controller 都需要用到某個 model 的資料來應用在各個 view 上面，<br>就不需要在每個 controller 上面都都進行 query，而且當 query 語句要變，你只需要改一個地方</p>
<p>在 AppServiceProvider</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">boot</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// option1 每一個view都進行query耗效能</span></span><br><span class="line">    View::share(<span class="string">'channels'</span>,Channel::orderBy(<span class="string">'name'</span>)-&gt;get());</span><br><span class="line">    <span class="comment">// option2 指定view進行query</span></span><br><span class="line">    View::composer([<span class="string">'post.*'</span>,<span class="string">'channel.index'</span>],<span class="function"><span class="keyword">function</span><span class="params">($view)</span></span>&#123;</span><br><span class="line">        $view-&gt;with(<span class="string">'channels'</span>,Channel::orderBy(<span class="string">'name'</span>)-&gt;get());</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Polymorphic-Relationships"><a href="#Polymorphic-Relationships" class="headerlink" title="Polymorphic Relationships"></a>Polymorphic Relationships</h1><p><a href="https://www.itdaan.com/blog/2011/03/22/1861cf1574aa7995b47010f2e11f87e2.html" target="_blank" rel="noopener">https://www.itdaan.com/blog/2011/03/22/1861cf1574aa7995b47010f2e11f87e2.html</a></p>
<p>多態的關聯不是真的表格中的關聯，而是定義在 class 中的關係，程式自己會去找欄位對應的關係<br>所以不必在建立表格時，設定 fk，也不必而外建立一張表，但要注意這是建立在 eloquent 層，而不是 db 層，如果刪除資料，別的資料並不會有所聯動<br><a href="https://youtu.be/6J8vb5_WRBw" target="_blank" rel="noopener">https://youtu.be/6J8vb5_WRBw</a></p>
<ul>
<li>1 對 1 的關係 ，不常見<br>例如： 一個人對應一個身份字號</li>
<li>1 對多的關係，最常見的一種<br>例如： 一個有多筆訂單</li>
<li>多對多的關係，在實際的表格設計中你就需要設計另外一個表個來存放關聯<br>例如：一個文章有多個標籤，一個標籤屬於多個文章</li>
</ul>
<h1 id="Facades"><a href="#Facades" class="headerlink" title="Facades"></a>Facades</h1><p>看起來像呼叫靜態方法的設計模式，配合著 service contaier 來做，達到用看似使用靜態方法的 code 來呼叫需要實例化的方法<br>不用像參數依賴注入一樣不需要在 register 註冊，直接使用更方便，你參數才不會議長串很難看，那跟依賴注入一樣，new 的動作就交給 container</p>
<p>在 AppServiceProvider</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">boot</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;app-&gt;singleton(<span class="string">'Postcard'</span>,<span class="function"><span class="keyword">function</span><span class="params">($app)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> PostcardSendingService(<span class="string">'us'</span>,<span class="string">'600'</span>,<span class="string">'400'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Macros"><a href="#Macros" class="headerlink" title="Macros"></a>Macros</h1><p>用來擴充 laravel 內建 class 方法 的方式，laravel 官網有列可以這樣擴充的清單</p>
<h1 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h1><h1 id="Repository-Pattern"><a href="#Repository-Pattern" class="headerlink" title="Repository Pattern"></a>Repository Pattern</h1><p>有人主张 controller 應該要愈少行愈清楚越好，<br>為了不讓 controller 參雜重複太多邏輯，有些人會把邏輯直接放在 model，讓 orm 的 find where 留在 model，但有時候商業邏輯牽扯到兩個 model 時，你是要將他寫在哪一個 model 呢？<br>所以有些人會特地抽出一層 repository 來，一切看你專案複雜度而定</p>
<p>好處是假如你哪一天 orm 換掉了，controller 和 model 也不會有太大變動，商業邏輯的部份特地切了出來</p>
<p>中小型專案並不建議導入，會增加專案的複雜度</p>
<p>為什 laravel 不內建這設計模式？<br>因為業界對於這個設計模式沒有一個準則<br><a href="https://stackoverflow.com/questions/60295553/creating-laravel-repositories-and-binding-as-service-providers" target="_blank" rel="noopener">https://stackoverflow.com/questions/60295553/creating-laravel-repositories-and-binding-as-service-providers</a></p>
<h1 id="Lazy-Collection"><a href="#Lazy-Collection" class="headerlink" title="Lazy Collection"></a>Lazy Collection</h1><p>底層是用 php 的 generator 來達成的，配合 for 和 yield 關鍵字，可以幫你省下不少記憶體，算是蠻少用的功能，但需要時就很實用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Collection::times(<span class="number">100000</span>)-&gt;map(<span class="function"><span class="keyword">function</span><span class="params">($number)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> pow(<span class="number">2</span>,$number);</span><br><span class="line">&#125;)-&gt;all();</span><br><span class="line">User::all();</span><br><span class="line"> <span class="comment">// vs</span></span><br><span class="line">LazyCollection::times(<span class="number">100000</span>)-&gt;map(<span class="function"><span class="keyword">function</span><span class="params">($number)</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> pow(<span class="number">2</span>,$number);</span><br><span class="line">&#125;)-&gt;all();</span><br><span class="line">User::cursor();</span><br></pre></td></tr></table></figure>

<h1 id="Soft-delete"><a href="#Soft-delete" class="headerlink" title="Soft delete"></a>Soft delete</h1><p>這也是很常用的功能<br>大部分的時候，如果你要刪除使用者，你並不會真的刪除他，而是把他隱藏起來<br>需要在 migration 做欄位的增加，通常會配合 policy 來實作</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">SoftDeletes</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span> <span class="keyword">extends</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">  <span class="keyword">use</span> <span class="title">SoftDelets</span></span><br><span class="line">  <span class="title">protected</span> $<span class="title">guarded</span> = [];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Notifications"><a href="#Notifications" class="headerlink" title="Notifications"></a>Notifications</h1><p>通知使用者的機器人，通常會有第三方的套件給你用</p>
<h1 id="laravel-design-pattern"><a href="#laravel-design-pattern" class="headerlink" title="laravel design pattern"></a>laravel design pattern</h1><p><a href="https://stackoverflow.com/questions/60029955/when-to-use-repository-vs-service-vs-trait-in-laravel" target="_blank" rel="noopener">https://stackoverflow.com/questions/60029955/when-to-use-repository-vs-service-vs-trait-in-laravel</a><br><a href="https://codesource.io/brief-overview-of-design-pattern-used-in-laravel/" target="_blank" rel="noopener">https://codesource.io/brief-overview-of-design-pattern-used-in-laravel/</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2020/09/17/%E4%BD%BF%E7%94%A8phpstorm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/17/%E4%BD%BF%E7%94%A8phpstorm/" class="post-title-link" itemprop="url">使用phpstorm</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-09-17 12:53:00" itemprop="dateCreated datePublished" datetime="2020-09-17T12:53:00+08:00">2020-09-17</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2021-07-30 18:11:28" itemprop="dateModified" datetime="2021-07-30T18:11:28+08:00">2021-07-30</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>因為決心要把 php 學好所以買了這款 ide<br><a href="https://curder.gitbooks.io/blog/content/tools/phpstorm/how-to-use-phpstorm-configures-php-code-sniffer-and-php-cs-fixer-to-support-psr2-specification.html" target="_blank" rel="noopener">https://curder.gitbooks.io/blog/content/tools/phpstorm/how-to-use-phpstorm-configures-php-code-sniffer-and-php-cs-fixer-to-support-psr2-specification.html</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2020/09/17/%E4%BD%BF%E7%94%A8workerman/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/17/%E4%BD%BF%E7%94%A8workerman/" class="post-title-link" itemprop="url">使用workerman</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-09-17 12:29:35" itemprop="dateCreated datePublished" datetime="2020-09-17T12:29:35+08:00">2020-09-17</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2022-01-05 11:04:25" itemprop="dateModified" datetime="2022-01-05T11:04:25+08:00">2022-01-05</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在許多的應用場合裡面，我們會需要定時執行或持續執行的 php，那實際應用方面，我們可能就會採用系統的排程來處理這件事，但是排程有幾個缺點<br>排程的時間是否能動態改變<br>排程如果在下一個排程之前都還沒執行完會不會造成資料錯誤<br>排程之間如果要如何共享資料<br>基於上述缺點<br>我們希望建一個 php 守護進程，如果要有一個 php 守護進程，我們必須要創一個無窮迴圈來處理這件事情<br><a href="https://alexwebdevelop.com/php-daemons/" target="_blank" rel="noopener">https://alexwebdevelop.com/php-daemons/</a><br>到最後出現<br>phpdaemon，reactphp，ratchet，workerman，swoole<br>等技術來處理我們的問題</p>
<p>直上官網連結<br><a href="https://www.workerman.net/workerman" target="_blank" rel="noopener">https://www.workerman.net/workerman</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2020/09/17/yii%E4%BD%BF%E7%94%A8Active-Record/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/17/yii%E4%BD%BF%E7%94%A8Active-Record/" class="post-title-link" itemprop="url">yii使用Active Record</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-09-17 12:22:16" itemprop="dateCreated datePublished" datetime="2020-09-17T12:22:16+08:00">2020-09-17</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2021-09-02 13:16:30" itemprop="dateModified" datetime="2021-09-02T13:16:30+08:00">2021-09-02</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="如何串接兩個資料表的資料"><a href="#如何串接兩個資料表的資料" class="headerlink" title="如何串接兩個資料表的資料"></a>如何串接兩個資料表的資料</h1><p>在 sql 語句裡面我們使用 UNION 關鍵字，那在 active record 裡面我們可以</p>
<p><a href="https://stackoverflow.com/questions/58535984/yii2-combine-data-from-multiple-queries-in-activedataprovider" target="_blank" rel="noopener">https://stackoverflow.com/questions/58535984/yii2-combine-data-from-multiple-queries-in-activedataprovider</a></p>
<h1 id="yii2-共用-controller"><a href="#yii2-共用-controller" class="headerlink" title="yii2 共用 controller"></a>yii2 共用 controller</h1><ul>
<li><p>new 一個 controller<br><a href="https://stackoverflow.com/questions/40751541/how-to-run-action-of-frontend-controller-from-backend-in-yii2?rq=1" target="_blank" rel="noopener">https://stackoverflow.com/questions/40751541/how-to-run-action-of-frontend-controller-from-backend-in-yii2?rq=1</a></p>
</li>
<li><p>從 url 下手<br><a href="https://stackoverflow.com/questions/50600193/yii2-frontend-to-backend-and-backend-to-frontend-controller-config-files-ht" target="_blank" rel="noopener">https://stackoverflow.com/questions/50600193/yii2-frontend-to-backend-and-backend-to-frontend-controller-config-files-ht</a></p>
</li>
</ul>
<p><a href="https://stackoverflow.com/questions/32964381/yii2-is-it-possible-to-open-a-frontend-session-from-backend" target="_blank" rel="noopener">https://stackoverflow.com/questions/32964381/yii2-is-it-possible-to-open-a-frontend-session-from-backend</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2020/09/10/%E4%BD%BF%E7%94%A8ansible/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/10/%E4%BD%BF%E7%94%A8ansible/" class="post-title-link" itemprop="url">使用ansible</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-09-10 10:39:44" itemprop="dateCreated datePublished" datetime="2020-09-10T10:39:44+08:00">2020-09-10</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2025-04-04 22:58:10" itemprop="dateModified" datetime="2025-04-04T22:58:10+08:00">2025-04-04</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>ansible 算是一個把yaml檔用到淋漓盡致的軟體，主要運用於同時多台自動化佈署，playbook 可以說是將yaml檔再做編譯的自創語言</p>
<p>假設我現在有三個節點，controller, node1, node2 我們的ansible會安裝在controller<br>那我們可以在個別節點<code>/etc/hostname</code>設定各自的名字<br>在controller節點的<code>/etc/hosts</code>設定對應的IP</p>
<h1 id="資源"><a href="#資源" class="headerlink" title="資源"></a>資源</h1><p><a href="https://www.youtube.com/watch?v=K0e7tjh3NFk&amp;list=PLfQqWeOCIH4BDoRx8lpXXl4hqSD4GSDU5" target="_blank" rel="noopener">https://www.youtube.com/watch?v=K0e7tjh3NFk&amp;list=PLfQqWeOCIH4BDoRx8lpXXl4hqSD4GSDU5</a></p>
<p><a href="https://ithelp.ithome.com.tw/articles/10185016" target="_blank" rel="noopener">https://ithelp.ithome.com.tw/articles/10185016</a></p>
<h1 id="inventory-ini"><a href="#inventory-ini" class="headerlink" title="inventory.ini"></a>inventory.ini</h1><p>相當於資產列表，一行代表一個節點的設定<br>遵守ini 的key-value格式<br>也可以加上中括號分組(group)</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 沒分組相當於[all]</span><br><span class="line">node1 ansible_connection=ssh ansible_user=root ansible_ssh_pass=password</span><br><span class="line">node2 ansible_connection=ssh ansible_user=root ansible_ssh_pass=password</span><br></pre></td></tr></table></figure>
<p>類似正則的匹配 node1~node100</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node[1:100] ansible_connection=ssh ansible_user=root ansible_ssh_pass=password</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[web1]</span></span><br><span class="line"><span class="comment"># node1 是設定好的hostname</span></span><br><span class="line">node1 ansible_connection=ssh ansible_user=root ansible_ssh_pass=password</span><br><span class="line"><span class="section">[web2]</span></span><br><span class="line">node2 ansible_connection=ssh ansible_user=root ansible_ssh_pass=password</span><br></pre></td></tr></table></figure>

<p>提取組變數(其實很少放在ini，通常都放yaml)</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[all]</span></span><br><span class="line">node1</span><br><span class="line">node2</span><br><span class="line"><span class="section">[all:vars]</span></span><br><span class="line"><span class="attr">ansible_connection</span>=ssh </span><br><span class="line"><span class="attr">ansible_user</span>=root </span><br><span class="line"><span class="attr">ansible_ssh_pass</span>=password</span><br></pre></td></tr></table></figure>
<h1 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h1><p>ansible的其中一個功能，跟一般的ping不一樣<br>all 所有的節點<br>-m module<br>-i 指定文件</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ansible node1 -m ping -i inventory.ini</span><br><span class="line">//or</span><br><span class="line">ansible web1 -m ping -i inventory.ini</span><br><span class="line">//all</span><br><span class="line">ansible all -m ping -i inventory.ini</span><br></pre></td></tr></table></figure>

<h1 id="ssh-key"><a href="#ssh-key" class="headerlink" title="ssh key"></a>ssh key</h1><p>在inventory.ini裡面我們通常不會放ansible_ssh_pass，因為實在是太危險<br>那我們通常都是用ssh key來進行登入，在controller上面生成ssh key</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br><span class="line">//接著命名，假設就叫ansible_controller</span><br><span class="line">ssh-copy-id -i ~/.ssh/ansible_controller node1</span><br><span class="line">//接著node1的~/.ssh/authorized_keys就會看到ansible_controller.pub</span><br></pre></td></tr></table></figure>
<p>這樣就算inventory.ini裡面沒有ansible_ssh_pass也沒有關係</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible node1 -m ping -i inventory.ini --private-key=/home/user/.ssh/ansible_controller</span><br></pre></td></tr></table></figure>

<h1 id="playbook"><a href="#playbook" class="headerlink" title="playbook"></a>playbook</h1><p>xml 格式繁瑣，數據冗餘<br>json 最流行，能代表的東西比較少<br>yaml yml 利用縮排和dash來表示</p>
<p>playbooks是ansible設定，佈署，編排的語言，透過yaml來編寫</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># playbook1.yaml</span></span><br><span class="line"><span class="attr">- host:</span> <span class="string">node1</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">play-test</span></span><br><span class="line"><span class="attr">  task:</span></span><br><span class="line"><span class="attr">    - name:</span> <span class="string">check</span> <span class="string">host</span> <span class="string">connection</span></span><br><span class="line"><span class="attr">      ping:</span></span><br></pre></td></tr></table></figure>
<p>之後就可以</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-playbook palybook1.yaml -i inventory.ini --private-key=/home/user/.ssh/</span><br></pre></td></tr></table></figure>

<h1 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h1><ul>
<li>inventory</li>
<li>playbook</li>
<li>module</li>
</ul>
<h1 id="debug"><a href="#debug" class="headerlink" title="debug"></a>debug</h1><p>相當重要的一個module，詳情請看文檔</p>
<h1 id="關鍵字"><a href="#關鍵字" class="headerlink" title="關鍵字"></a>關鍵字</h1><ul>
<li>item 用來做loop用</li>
<li>雙重大括號讀取變數用，裡面可以放python語法</li>
<li>or</li>
</ul>
<h1 id="基本功能"><a href="#基本功能" class="headerlink" title="基本功能"></a>基本功能</h1><ul>
<li>with_items 提供loop變數</li>
<li>with_nested 提供nested loop變數(試著映出99乘法表)</li>
<li>var 宣告變數</li>
<li>var_files 變數的檔案</li>
<li>when 條件語句</li>
<li>become 使用root身分</li>
<li>gather_facts 獲取主機訊息，ansible默認打開，這些訊息可以當成變數來獲取</li>
</ul>
<h1 id="資料夾名"><a href="#資料夾名" class="headerlink" title="資料夾名"></a>資料夾名</h1><p>ansible 會透過資料夾名來讀資料</p>
<ul>
<li>inventory 最上層的目錄<ul>
<li>group_vars</li>
<li>host_vars</li>
</ul>
</li>
</ul>
<h1 id="設定檔"><a href="#設定檔" class="headerlink" title="設定檔"></a>設定檔</h1><p>會查找4個地方(優先級遞減):</p>
<ol>
<li>palybook.yaml所在目錄的ansible.cfg</li>
<li>export ANSIBLE_CONFIG=ansible.cfg</li>
<li>/home/user/底下的ansible.cfg</li>
<li>/etc/ansible.cfg</li>
</ol>
<p>每次要都要指定餐參數i 覺得麻煩</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-playbook palybook1.yaml -i inventory.ini</span><br></pre></td></tr></table></figure>

<p>ansible.cfg</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[defaults]</span></span><br><span class="line"><span class="attr">inventory</span> = ./inventory</span><br></pre></td></tr></table></figure>
<p>設定完之後就可以直接</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-playbook palybook1.yaml</span><br></pre></td></tr></table></figure>

<h1 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h1><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m shell -a "less /www/index.html"</span><br></pre></td></tr></table></figure>

<h1 id="template"><a href="#template" class="headerlink" title="template"></a>template</h1><p>假設你使用copy，但你不同主機所需要上複製的檔案不完全一樣時，就可以使用template，可以將其視為更高級的copy<br>jinja是python的模板語言，裡面可以使用python的for語法ect</p>
<h1 id="yum"><a href="#yum" class="headerlink" title="yum"></a>yum</h1><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">task:</span></span><br><span class="line"><span class="attr">  - name:</span> <span class="string">install</span> <span class="string">git</span></span><br><span class="line"><span class="attr">    yum:</span></span><br><span class="line"><span class="attr">      name:</span> <span class="string">git</span></span><br><span class="line"><span class="attr">      state:</span> <span class="string">present</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2020/09/04/%E4%B8%8D%E5%B8%B8%E7%94%A8%E6%9C%83%E5%BF%98%E8%A8%98%E7%9A%84windows%E6%8C%87%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/04/%E4%B8%8D%E5%B8%B8%E7%94%A8%E6%9C%83%E5%BF%98%E8%A8%98%E7%9A%84windows%E6%8C%87%E4%BB%A4/" class="post-title-link" itemprop="url">不常用會忘記的windows指令</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-09-04 11:48:12" itemprop="dateCreated datePublished" datetime="2020-09-04T11:48:12+08:00">2020-09-04</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2021-07-30 18:11:28" itemprop="dateModified" datetime="2021-07-30T18:11:28+08:00">2021-07-30</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DevOps%E8%B7%AF%E7%B7%9A/" itemprop="url" rel="index"><span itemprop="name">DevOps路線</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DevOps%E8%B7%AF%E7%B7%9A/%E7%AE%A1%E7%90%86%E4%BC%BA%E6%9C%8D%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">管理伺服器</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DevOps%E8%B7%AF%E7%B7%9A/%E7%AE%A1%E7%90%86%E4%BC%BA%E6%9C%8D%E5%99%A8/%E4%BD%9C%E6%A5%AD%E7%B3%BB%E7%B5%B1/" itemprop="url" rel="index"><span itemprop="name">作業系統</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="如何在新的一行-echo-出東西"><a href="#如何在新的一行-echo-出東西" class="headerlink" title="如何在新的一行 echo 出東西"></a>如何在新的一行 echo 出東西</h1><p><a href="https://stackoverflow.com/questions/132799/how-can-i-echo-a-newline-in-a-batch-file" target="_blank" rel="noopener">https://stackoverflow.com/questions/132799/how-can-i-echo-a-newline-in-a-batch-file</a></p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo hello &amp; echo.world</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2020/07/28/%E4%BD%BF%E7%94%A8shell-script/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/28/%E4%BD%BF%E7%94%A8shell-script/" class="post-title-link" itemprop="url">使用shell script</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-07-28 09:48:13" itemprop="dateCreated datePublished" datetime="2020-07-28T09:48:13+08:00">2020-07-28</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-03-18 10:29:13" itemprop="dateModified" datetime="2023-03-18T10:29:13+08:00">2023-03-18</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>shell script 是初階維運必備技能<br>shell 是殼的意思，文字介面底下讓我們與系統溝通的一個工具介面，有自己的語法，其速度並沒有傳統程式語言的快<br><a href="http://linux.vbird.org/linux_basic/0320bash.php" target="_blank" rel="noopener">http://linux.vbird.org/linux_basic/0320bash.php</a><br>例如 sh, bash, csh, tcsh,Powershell, MSDOS<br>可以與系統程式語言都可以寫 script，只不過他不附帶工具界面，就不叫他 shell script 了<br>例如 perl，php，java, python<br>為什麼沒有 c 呢？因為 c 不是直譯而是編譯的，<br>那 java 呢？因為 java 編譯出的是字節碼（需要透過 jdk 來執行），不是機器碼，cpu 不能直接用</p>
<p>那為什麼有了 python 這些，還需要有 shell script 呢？<br><a href="https://stackoverflow.com/questions/2785155/php-vs-bash-for-cli-scripting/2785163#2785163" target="_blank" rel="noopener">https://stackoverflow.com/questions/2785155/php-vs-bash-for-cli-scripting/2785163#2785163</a></p>
<p>那在這篇探討最通用的 sh<br>，本身語法難度相較於其他程式語言並不難，難的是你必須要會操作軟體的指令，例如 nginx 指令，git 指令等等</p>
<p>既然是程式語言，就可以做任何事，但因為速度不快，比較長應用在維運方面，常見的應用</p>
<ul>
<li>初始化（軟體安裝）</li>
<li>自動佈署（lamp，lnmp）</li>
<li>寫管理應用程序（叢集管理，kvm，nginx，mysql，批量遠端 raid）</li>
<li>log 分析（grep）</li>
<li>自動化備份</li>
<li>監控（cpu，disk）</li>
<li>自動擴充（監控 &gt;&gt; API AWS/EC2 &gt;&gt; shell script 自動佈署）</li>
</ul>
<p>那以上應用也有不同軟體可以達成，不一定要用 sh，例如老牌 zabbix 監控軟體，絕對比自己寫 sh 好</p>
<h1 id="常用指令"><a href="#常用指令" class="headerlink" title="常用指令"></a>常用指令</h1><p>列出所有 shell<br>cat /etc/shells</p>
<p>查詢相關配置文件<br>rpm -qc bash</p>
<p>調適腳本 debug<br>bash -vx pinggoogle.sh</p>
<h2 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h2><p>查看別名<br>alias<br>定義臨時別名<br>aias stanley = ‘date’<br>定義永久別名<br>vim .bashrc<br>取消別名<br>unalias 別名</p>
<h2 id="歷史相關指令"><a href="#歷史相關指令" class="headerlink" title="歷史相關指令"></a>歷史相關指令</h2><p>!! 上個命令<br>!$ 上個命令的最後一個參數</p>
<h1 id="規則"><a href="#規則" class="headerlink" title="規則"></a>規則</h1><h1 id="分類"><a href="#分類" class="headerlink" title="分類"></a>分類</h1><ul>
<li>login shell（ su - stanley）<ul>
<li>/etc/profile</li>
<li>/etc/bashrc</li>
<li>~/.bash_profile</li>
<li>~/.bashrc</li>
</ul>
</li>
<li>nologin shell ( su stanley)<ul>
<li>/ect/bashrc</li>
<li>~/.bashrc</li>
</ul>
</li>
</ul>
<h2 id="文件開頭"><a href="#文件開頭" class="headerlink" title="文件開頭"></a>文件開頭</h2><p>#!/usr/bin/bash<br>#!/usr/bin/python<br>指定解釋器</p>
<blockquote>
<p>chmod +x pinggoogle.sh</p>
</blockquote>
<p>就可以直接執行<br>sub shell 會另開 shell</p>
<blockquote>
<p>./pinggoole.sh</p>
</blockquote>
<p>或是</p>
<blockquote>
<p>. pinggoole.sh<br>source pinggoogle.sh</p>
</blockquote>
<p>會影響當前 shell 的執行（目前的視窗）<br>否則就必須前面訂解釋器</p>
<p>sub shell 會另開 shell</p>
<blockquote>
<p>bash pinggoogle.sh</p>
</blockquote>
<h2 id="兩段不同語言混雜"><a href="#兩段不同語言混雜" class="headerlink" title="兩段不同語言混雜"></a>兩段不同語言混雜</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"im bash"</span></span><br><span class="line"></span><br><span class="line">/usr/bin/python &lt;&lt;-EOF</span><br><span class="line"><span class="built_in">print</span> <span class="string">"im python"</span></span><br><span class="line">EOF</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'im bash'</span></span><br></pre></td></tr></table></figure>

<p>上面這段代碼，EOF 是約定俗成，可自由定義，其中&lt;&lt;-的-可以避免縮進問題<br>例如</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"im bash"</span></span><br><span class="line"></span><br><span class="line">/usr/bin/python &lt;&lt;EOF</span><br><span class="line"><span class="built_in">print</span> <span class="string">"im python"</span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<p>上面這段去掉-就會報錯</p>
<h2 id="範例-1"><a href="#範例-1" class="headerlink" title="範例 1"></a>範例 1</h2><p>ping 一次</p>
<blockquote>
<p>ping -c1 google.com &amp;&gt;/dev/null &amp;&amp; echo “google is alive” || echo “google is down”<br>&amp;&amp;和||相當於三元運算子<br>&amp;&gt;/dev/null 將過程輸出到/dev/null 不顯示</p>
</blockquote>
<h2 id="shell-環境變量"><a href="#shell-環境變量" class="headerlink" title="shell 環境變量"></a>shell 環境變量</h2><p>相關內容鳥哥的網站都有說<br><a href="https://www.cntofu.com/book/46/linux_system/1517.md" target="_blank" rel="noopener">https://www.cntofu.com/book/46/linux_system/1517.md</a></p>
<p>set:顯示(設置)shell 變量 包括的私有變量以及用戶變量，不同類的 shell 有不同的私有變量 bash,ksh,csh 每中 shell 私有變量都不一樣</p>
<p>env:顯示(設置)用戶變量變量</p>
<p>export:顯示(設置)當前導出成用戶變量的 shell 變量。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2020/07/09/%E5%AE%89%E8%A3%9Dwordpress/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/09/%E5%AE%89%E8%A3%9Dwordpress/" class="post-title-link" itemprop="url">安裝wordpress</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-07-09 14:51:26" itemprop="dateCreated datePublished" datetime="2020-07-09T14:51:26+08:00">2020-07-09</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2025-04-04 22:59:04" itemprop="dateModified" datetime="2025-04-04T22:59:04+08:00">2025-04-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/wordpress/" itemprop="url" rel="index"><span itemprop="name">wordpress</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/wordpress/sage/" itemprop="url" rel="index"><span itemprop="name">sage</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>對於接案的人來說，你重頭開始造輪子是不可能的，沒有那個時間精力，要不就是拿現有工作的 code 來改，要不就是開源專案選一個來寫，<br>那以前工作都是 laravel 客製化公司後台，對於 cms 這種案子的派不上太多用場，勢必要用流行的 cms 框架，其中就選擇最多人用的 wordpress<br><a href="https://wordpress.org/showcase/" target="_blank" rel="noopener">https://wordpress.org/showcase/</a></p>
<p>不過也出了純 js 版的專案<br>Github 平臺最有價值的 100 個專案<br><a href="https://github.com/Automattic/wp-calypso" target="_blank" rel="noopener">https://github.com/Automattic/wp-calypso</a></p>
<h1 id="wordpress-本地開發"><a href="#wordpress-本地開發" class="headerlink" title="wordpress 本地開發"></a>wordpress 本地開發</h1><p>網路上有很多資源介紹如何本地開發，和設定本地環境<br><a href="https://roots.io/docs/bedrock/master/local-development/#additional-resources" target="_blank" rel="noopener">https://roots.io/docs/bedrock/master/local-development/#additional-resources</a></p>
<h1 id="wordpress-網站範例"><a href="#wordpress-網站範例" class="headerlink" title="wordpress 網站範例"></a>wordpress 網站範例</h1><p><a href="https://inciteresponse.com/hotel-websites-built-using-wordpress/" target="_blank" rel="noopener">https://inciteresponse.com/hotel-websites-built-using-wordpress/</a></p>
<h1 id="理想的-wordpress-開發流程"><a href="#理想的-wordpress-開發流程" class="headerlink" title="理想的 wordpress 開發流程"></a>理想的 wordpress 開發流程</h1><p>非常重要的影片<br><a href="https://youtu.be/mzs-X2z-96Y" target="_blank" rel="noopener">https://youtu.be/mzs-X2z-96Y</a></p>
<h1 id="oracle-cloud"><a href="#oracle-cloud" class="headerlink" title="oracle cloud"></a>oracle cloud</h1><p>免費一年的 aws 過期了<br>出現 Permission denied (publickey).<br>一開始以為是預設金鑰抓錯了<br>ssh -i /home/stanley/.ssh/id_rsa <a href="mailto:ubuntu@168.138.46.17" target="_blank" rel="noopener">ubuntu@168.138.46.17</a><br>後來才發現要指定使用者阿～～<br>ssh <a href="mailto:ubuntu@168.138.46.17" target="_blank" rel="noopener">ubuntu@168.138.46.17</a></p>
<h1 id="trellis"><a href="#trellis" class="headerlink" title="trellis"></a>trellis</h1><p>看 github 的 about 介紹 Ansible playbooks for a WordPress</p>
<p><a href="https://www.youtube.com/watch?v=-pOKTtAfJ8M" target="_blank" rel="noopener">https://www.youtube.com/watch?v=-pOKTtAfJ8M</a><br>It appears your machine doesn’t support NFS, or there is not an<br>adapter to enable NFS on this machine for Vagrant.</p>
<blockquote>
<p>sudo apt-get install portmap nfs-kernel-server</p>
</blockquote>
<p>解釋一下 trellis 做了什麼，他幫忙在本機設定好虛擬的環境，就是有可能你是 windows 用戶 code 要放在 linux 上，但是他並不會在遠端也幫你建一個虛擬機，所以你的遠端伺服器的作業系統一定要是 ubuntu<br>Trellis runs on Ubuntu 18.04 LTS (Bionic Beaver) based servers</p>
<h1 id="接案報價"><a href="#接案報價" class="headerlink" title="接案報價"></a>接案報價</h1><p>阿接案的新手如果不知道報價的話，可以參考網路上的一些公司<br><a href="https://wpw.design/price-wordpress/" target="_blank" rel="noopener">https://wpw.design/price-wordpress/</a></p>
<h1 id="開發"><a href="#開發" class="headerlink" title="開發"></a>開發</h1><h2 id="wordpress-社群"><a href="#wordpress-社群" class="headerlink" title="wordpress 社群"></a>wordpress 社群</h2><p>wordpress 的社群氛圍相對其他框架，並不是那麼優良<br>因為 wordpress 定位為”不會寫程式的人也會用”，爾且全球使用的人實在太多，這造就了很多人問問題就只是要答案複製貼上，沒什麼反饋<br>我們都會這樣了，何況是不會寫程式的人，所以種種原因會讓你在問題定位上遇到困難</p>
<h2 id="wordpress-設計模式"><a href="#wordpress-設計模式" class="headerlink" title="wordpress 設計模式"></a>wordpress 設計模式</h2><p>義大利麵,wordpress 是很久的專案了，對於熟悉現代框架的我們，寫起來其實是相當痛苦，整個專案是程序導向的方式，沒什麼規範<br><a href="https://wordpress.stackexchange.com/questions/169812/what-is-the-design-pattern-for-wordpress-core" target="_blank" rel="noopener">https://wordpress.stackexchange.com/questions/169812/what-is-the-design-pattern-for-wordpress-core</a></p>
<p>那硬要說的話，wordpress 採事件驅動的開發模式，那缺點是什麼？<br>整個生命週期安插了許多的事件，使用者自訂的事件，你必須要對生命週期有一定程度的了解，在加上哪些地方有用的到這個事件，可能有很多地方都對這個事件添加了 handler<br>變成不好管理<br>hook function 就是我們俗稱的 callback<br>分為兩種<br>action hook 是 <strong>沒有</strong> 回傳值的 callback<br>filter hook 是 <strong>有</strong> 回傳值的 callback<br>然後如何決定這些 handler 的順序？<br>就會有個 Priority 參數<br>然後可以透過$wp_filters[‘事件名’]這個 global 變數來取得所有 hook 的資訊</p>
<p><a href="https://audilu.com/2011/10/10/wordpress-hook/" target="_blank" rel="noopener">https://audilu.com/2011/10/10/wordpress-hook/</a></p>
<p>然後 wordpress 在 php 還沒有物件導向時就出來了，也沒有硬性規定你的寫法，可以用程序導向，也可以用物件導向，所以在命名規則上，就會有一些約定，<br>像是 function 前面要加上主題的前綴，避免和插件等等命名發生重複</p>
<p>其餘內建的命名規則：<br>get_the_XXX()不會打印，只會回傳值<br>the_XXX()會印出東西</p>
<h2 id="如何改進開發體驗"><a href="#如何改進開發體驗" class="headerlink" title="如何改進開發體驗"></a>如何改進開發體驗</h2><p>在開發 wordpress 時，會發現用到很多的 function 很多的 callback，所以選對 ide 來開發 wordpress 顯得相當重要，哪個時期哪些功能要用到哪些 wp 的 api 也很重要</p>
<p>wordpress 寫 code 容易寫出義大利麵<br>話雖然是這樣說，但裡面龐大的資源是大家不能夠輕易放棄的，所以就有許多 opensource 專案出來，希望讓 wordpress 開發比較符合現代開發方式</p>
<h2 id="開發類型"><a href="#開發類型" class="headerlink" title="開發類型"></a>開發類型</h2><p><a href="https://developer.wordpress.org/" target="_blank" rel="noopener">https://developer.wordpress.org/</a></p>
<p>主要分成</p>
<ul>
<li>插件開發</li>
<li>主題開發</li>
</ul>
<p>你可以看到網路上許多在賣主題，或插件的，對我們接案的來說你的功能都會在主題開發完成，有需要共用的功能才需要花心力抽成插件</p>
<h2 id="sage-起手主題"><a href="#sage-起手主題" class="headerlink" title="sage 起手主題"></a>sage 起手主題</h2><p>sage 是能夠讓你快速開發 wordpress 主題的 Boilerplate，引入了 laravel 的 blade 模板引擎，以及前端工程化的 webpack<br>照著文檔規則走可以讓你很輕鬆的把現代開發融入 wordpress 主題開發之中，就是資料夾結構都幫你定義好了，照做就行</p>
<h2 id="管理插件"><a href="#管理插件" class="headerlink" title="管理插件"></a>管理插件</h2><p>wordpress 的插件都是放在自己定義的 plugins 資料夾，但我們現在都是用 composer 來管理現代專案了，所以必須要將原本指向 vendor 的資料夾改指向 plugins<br><a href="https://n3xtchen.github.io/n3xtchen/php/2015/02/15/wordpress-n-composer" target="_blank" rel="noopener">https://n3xtchen.github.io/n3xtchen/php/2015/02/15/wordpress-n-composer</a><br><a href="https://roots.io/using-composer-with-wordpress/" target="_blank" rel="noopener">https://roots.io/using-composer-with-wordpress/</a></p>
<h2 id="bedrock"><a href="#bedrock" class="headerlink" title="bedrock"></a>bedrock</h2><p>為了讓 wordpress 能夠使用 composere 管理插件，就出現了這個專案啦，但是這個專案並不能更新，因為他也是 Boilerplate,沒辦法像更新插件一樣輕鬆更新，就像你在更新框架也很麻煩一樣，不過沒關係 wordpress 可以正常更新就好<br><a href="https://discourse.roots.io/t/how-to-update-wordpress-bedrock-after-deployment/3741/8" target="_blank" rel="noopener">https://discourse.roots.io/t/how-to-update-wordpress-bedrock-after-deployment/3741/8</a></p>
<h3 id="開放套件按裝和刪除"><a href="#開放套件按裝和刪除" class="headerlink" title="開放套件按裝和刪除"></a>開放套件按裝和刪除</h3><p>基於甲方可能亂刪套件亂裝套件導致網站壞掉，最好還是關掉這個功能<br><a href="https://discourse.roots.io/t/does-bedrock-trellis-disable-the-ability-to-add-install-plugins-via-admin/6925/6" target="_blank" rel="noopener">https://discourse.roots.io/t/does-bedrock-trellis-disable-the-ability-to-add-install-plugins-via-admin/6925/6</a></p>
<h2 id="wp-cli"><a href="#wp-cli" class="headerlink" title="wp-cli"></a>wp-cli</h2><p>wordpress 有成千上萬的套件，一個站一定會用上個幾個，那你又不可能每次都手動去後台安裝套件，再來啟用，太花時間了<br>就算插件能用 composer 做管理，插件的啟用還是得要上後台開啟，所以就有了 wp-cli 這工具讓你可以下指令做啟用，<br>只要你會寫腳本運用 wpcli，專案套件的管理和啟用就不是什麼難事，工程師就也不一定要用 composer 來做管理，wp—cli 能開啟關閉套件還更方便些</p>
<p>所以我想這也有可能是 wordpress 自今一直沒改資料夾結構的原因之一，旨在一般大眾就可以使用，平易近人，工程師自己要用 composer 就自己想辦法<br><a href="https://wp-cli.org/zh-cn/" target="_blank" rel="noopener">https://wp-cli.org/zh-cn/</a></p>
<h2 id="前後端分離"><a href="#前後端分離" class="headerlink" title="前後端分離"></a>前後端分離</h2><h3 id="wpapi"><a href="#wpapi" class="headerlink" title="wpapi"></a>wpapi</h3><p>wordpress 設計的 rest api，讓你前後端分離，但是在設計上每個請求都會經過一大堆插件，不是直接與 db 做溝通，爾且也不是每個插件都支援 wpapi，要看作者有沒有寫</p>
<h3 id="wpgrahql"><a href="#wpgrahql" class="headerlink" title="wpgrahql"></a>wpgrahql</h3><p>wordpress 就是好用在他的插件，當你使用 wpgrahql 前後端分離的時候，就需要考慮到說，那我用 wordpress 幹什麼？<br>好處是因為他是直接跟資料庫做溝通，不會經過插件，就變成你只需要他的後台</p>
<h2 id="ACF-自動導入-json"><a href="#ACF-自動導入-json" class="headerlink" title="ACF 自動導入 json"></a>ACF 自動導入 json</h2><p><a href="https://support.advancedcustomfields.com/forums/topic/auto-import-json-export-file/" target="_blank" rel="noopener">https://support.advancedcustomfields.com/forums/topic/auto-import-json-export-file/</a></p>
<h2 id="ACF-頁面編輯頁移除齒輪"><a href="#ACF-頁面編輯頁移除齒輪" class="headerlink" title="ACF 頁面編輯頁移除齒輪"></a>ACF 頁面編輯頁移除齒輪</h2><p><a href="https://support.advancedcustomfields.com/forums/topic/remove-edit-field-group-cog/" target="_blank" rel="noopener">https://support.advancedcustomfields.com/forums/topic/remove-edit-field-group-cog/</a></p>
<h2 id="CPTUI-自動導入-json"><a href="#CPTUI-自動導入-json" class="headerlink" title="CPTUI 自動導入 json"></a>CPTUI 自動導入 json</h2><p><a href="https://github.com/WebDevStudios/custom-post-type-ui/issues/381" target="_blank" rel="noopener">https://github.com/WebDevStudios/custom-post-type-ui/issues/381</a></p>
<h2 id="安裝-wordpress"><a href="#安裝-wordpress" class="headerlink" title="安裝 wordpress"></a>安裝 wordpress</h2><p><a href="https://www.datanovia.com/en/lessons/using-docker-wordpress-cli-to-manage-wordpress-websites/" target="_blank" rel="noopener">https://www.datanovia.com/en/lessons/using-docker-wordpress-cli-to-manage-wordpress-websites/</a><br><a href="https://stackoverflow.com/questions/50999848/how-to-run-wp-cli-in-docker-compose-yml" target="_blank" rel="noopener">https://stackoverflow.com/questions/50999848/how-to-run-wp-cli-in-docker-compose-yml</a></p>
<p><a href="https://medium.com/@tatemz/using-wp-cli-with-docker-21b0ab9fab79" target="_blank" rel="noopener">https://medium.com/@tatemz/using-wp-cli-with-docker-21b0ab9fab79</a></p>
<p><a href="https://gist.github.com/bradtraversy/faa8de544c62eef3f31de406982f1d42" target="_blank" rel="noopener">https://gist.github.com/bradtraversy/faa8de544c62eef3f31de406982f1d42</a></p>
<p>要執行服務裡面的指令可以<br>sudo docker-compose run –rm wordpress-cli post list<br>docker-compose run –rm cli bash</p>
<p>alias wp=”sudo docker-compose run –rm wordpress-cli”<br>這樣以後就可以<br>wp post list</p>
<h1 id="wordpress-翻譯"><a href="#wordpress-翻譯" class="headerlink" title="wordpress 翻譯"></a>wordpress 翻譯</h1><p>sudo apt-get install poedit<br>不這樣做的話，poedit 會沒有權限打開一些檔案</p>
<p><a href="https://roots.io/docs/sage/9.x/localization/#generating-language-files" target="_blank" rel="noopener">https://roots.io/docs/sage/9.x/localization/#generating-language-files</a></p>
<p>做本地化一直沒有成功，最後還是依賴上述連結所提的<br>See Sage_Polylang_Theme_Translation<br>相關插件來翻譯</p>
<h1 id="不用-walker-做-menu"><a href="#不用-walker-做-menu" class="headerlink" title="不用 walker 做 menu"></a>不用 walker 做 menu</h1><p><a href="https://developer.wordpress.org/reference/functions/wp_get_nav_menu_items/" target="_blank" rel="noopener">https://developer.wordpress.org/reference/functions/wp_get_nav_menu_items/</a></p>
<h1 id="付費的-plugin-如何用-composer-安裝"><a href="#付費的-plugin-如何用-composer-安裝" class="headerlink" title="付費的 plugin 如何用 composer 安裝"></a>付費的 plugin 如何用 composer 安裝</h1><p><a href="https://roots.io/guides/private-or-commercial-wordpress-plugins-as-composer-dependencies/" target="_blank" rel="noopener">https://roots.io/guides/private-or-commercial-wordpress-plugins-as-composer-dependencies/</a><br><a href="https://roots.io/guides/acf-pro-as-a-composer-dependency-with-encrypted-license-key/" target="_blank" rel="noopener">https://roots.io/guides/acf-pro-as-a-composer-dependency-with-encrypted-license-key/</a><br><a href="https://getcomposer.org/doc/articles/handling-private-packages-with-satis.md" target="_blank" rel="noopener">https://getcomposer.org/doc/articles/handling-private-packages-with-satis.md</a></p>
<h1 id="如何一鍵搬移資料庫"><a href="#如何一鍵搬移資料庫" class="headerlink" title="如何一鍵搬移資料庫"></a>如何一鍵搬移資料庫</h1><p><a href="https://github.com/jasperf/trellis-sync" target="_blank" rel="noopener">https://github.com/jasperf/trellis-sync</a></p>
<p><a href="https://roots.io/plugins/sync-script/" target="_blank" rel="noopener">https://roots.io/plugins/sync-script/</a></p>
<h1 id="安裝-sage"><a href="#安裝-sage" class="headerlink" title="安裝 sage"></a>安裝 sage</h1><p>會遇到問題</p>
<figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.node-gyp/12.1.0/include/node/v8.h:3002:5: note: candidate constructor not viable: no known conversion from 'v8::Local&lt;v8::Value&gt;' to 'const v8::String::Utf8Value' for 1st argument</span><br><span class="line">    Utf8Value(const Utf8Value&amp;) = delete;</span><br></pre></td></tr></table></figure>

<p>因為 node-sass needs to be version 4.12.0 for Node.js 12 support<br>所以記得去 update 一下 node-sass 的版本</p>
<h1 id="如果發現套件沒安裝好，可能是你改完-composer-json-之後沒有-update"><a href="#如果發現套件沒安裝好，可能是你改完-composer-json-之後沒有-update" class="headerlink" title="如果發現套件沒安裝好，可能是你改完 composer.json 之後沒有 update"></a>如果發現套件沒安裝好，可能是你改完 composer.json 之後沒有 update</h1><p><a href="https://discourse.roots.io/t/trellis-deploy-composer-uses-old-version-of-package-loading-from-cache/7186" target="_blank" rel="noopener">https://discourse.roots.io/t/trellis-deploy-composer-uses-old-version-of-package-loading-from-cache/7186</a></p>
<h1 id="在佈署完之後裝啟用語言"><a href="#在佈署完之後裝啟用語言" class="headerlink" title="在佈署完之後裝啟用語言"></a>在佈署完之後裝啟用語言</h1><p><a href="https://discourse.roots.io/t/adding-wp-language-files-on-deploy/9212/34" target="_blank" rel="noopener">https://discourse.roots.io/t/adding-wp-language-files-on-deploy/9212/34</a></p>
<h1 id="在佈署完之後啟用插件"><a href="#在佈署完之後啟用插件" class="headerlink" title="在佈署完之後啟用插件"></a>在佈署完之後啟用插件</h1><p><a href="https://discourse.roots.io/t/activate-plugins-after-added-via-composer-json/12790" target="_blank" rel="noopener">https://discourse.roots.io/t/activate-plugins-after-added-via-composer-json/12790</a><br>利用 composer 的 hook<br>但是，trellis 在 deploy 之後似乎不會每次都觸發 composer update 或 composer install<br>所以套件並沒有因此而啟用，這需要再測試一下<br>測試之後發現新加了 plugin 還是不會觸發 composer hook<br>看來在 trellis 要另尋方法了<br><a href="https://discourse.roots.io/t/plugin-activation-task-during-vagrant-provisioning/5803/4" target="_blank" rel="noopener">https://discourse.roots.io/t/plugin-activation-task-during-vagrant-provisioning/5803/4</a><br><a href="https://discourse.roots.io/t/composer-install-with-no-scripts-doesnt-work/13743/12" target="_blank" rel="noopener">https://discourse.roots.io/t/composer-install-with-no-scripts-doesnt-work/13743/12</a></p>
<h1 id="更自動化一點"><a href="#更自動化一點" class="headerlink" title="更自動化一點"></a>更自動化一點</h1><p>Let’s say I would like every commit to github to be automatically deployed to my staging server?<br>不用在本機打指令，這樣就要用到 ci/cd 啟一個 server 來跑 deploy 指令了</p>
<p><a href="https://discourse.roots.io/t/automated-deployment/6536" target="_blank" rel="noopener">https://discourse.roots.io/t/automated-deployment/6536</a></p>
<h1 id="利用-ACF-客製化主題設定"><a href="#利用-ACF-客製化主題設定" class="headerlink" title="利用 ACF 客製化主題設定"></a>利用 ACF 客製化主題設定</h1><p><a href="https://youtu.be/Dlsr5uVOMRI" target="_blank" rel="noopener">https://youtu.be/Dlsr5uVOMRI</a></p>
<h1 id="搭配-sage-要做-composer-install-的-hook"><a href="#搭配-sage-要做-composer-install-的-hook" class="headerlink" title="搭配 sage 要做 composer install 的 hook"></a>搭配 sage 要做 composer install 的 hook</h1><p><a href="https://discourse.roots.io/t/help-sage-autoloader-errors-after-activating-theme-after-seemingly-successful-deploy/9991" target="_blank" rel="noopener">https://discourse.roots.io/t/help-sage-autoloader-errors-after-activating-theme-after-seemingly-successful-deploy/9991</a></p>
<h1 id="語言問題"><a href="#語言問題" class="headerlink" title="語言問題"></a>語言問題</h1><p><a href="https://discourse.roots.io/t/manage-plugin-translations-current-approaches/9108" target="_blank" rel="noopener">https://discourse.roots.io/t/manage-plugin-translations-current-approaches/9108</a></p>
<p><a href="https://github.com/roots/bedrock/issues/30" target="_blank" rel="noopener">https://github.com/roots/bedrock/issues/30</a></p>
<h1 id="環境佈署"><a href="#環境佈署" class="headerlink" title="環境佈署"></a>環境佈署</h1><p>wp search-replace ‘//happypanda.subnet.vcn.oraclevcn.com/wp’ ‘//happypanda.tw’</p>
<p>wp search-replace ‘happypanda.subnet.vcn.oraclevcn.com/app/‘ ‘happypanda.tw/wp-content/‘</p>
<h1 id="後續處理"><a href="#後續處理" class="headerlink" title="後續處理"></a>後續處理</h1><p>安裝 lighthouse 來做網站相關優化處理</p>
<h1 id="前端工程化"><a href="#前端工程化" class="headerlink" title="前端工程化"></a>前端工程化</h1><p><a href="https://awdr74100.github.io/2020-02-26-webpack-cssloader-styleloader/" target="_blank" rel="noopener">https://awdr74100.github.io/2020-02-26-webpack-cssloader-styleloader/</a></p>
<h1 id="trellis-備份相關腳本"><a href="#trellis-備份相關腳本" class="headerlink" title="trellis 備份相關腳本"></a>trellis 備份相關腳本</h1><p>等待研究<br><a href="https://github.com/ItinerisLtd/trellis-backup-during-deploy" target="_blank" rel="noopener">https://github.com/ItinerisLtd/trellis-backup-during-deploy</a></p>
<h1 id="wordpress-api"><a href="#wordpress-api" class="headerlink" title="wordpress api"></a>wordpress api</h1><p>wordpress 防 csrf<br><a href="https://trepmal.com/2018/01/26/cookie-nonce-authentication-for-rest-api-curl-requests/" target="_blank" rel="noopener">https://trepmal.com/2018/01/26/cookie-nonce-authentication-for-rest-api-curl-requests/</a></p>
<h1 id="試著複寫插件提供的-fucntion"><a href="#試著複寫插件提供的-fucntion" class="headerlink" title="試著複寫插件提供的 fucntion"></a>試著複寫插件提供的 fucntion</h1><p>為了沒裝插件時也能正常執行</p>
<p><a href="https://wordpress.stackexchange.com/questions/243168/providing-fallback-function-and-allow-override-by-plugin" target="_blank" rel="noopener">https://wordpress.stackexchange.com/questions/243168/providing-fallback-function-and-allow-override-by-plugin</a><br>或者應該把插件放到 must pulgin 才是</p>
<h1 id="避免-query-錯"><a href="#避免-query-錯" class="headerlink" title="避免 query 錯"></a>避免 query 錯</h1><ul>
<li>wp_reset_query() - ensure that the main query has been reset to the original main query</li>
<li>wp_reset_postdata() - ensures that the global $post has been restored to the current post in the main query.</li>
</ul>
<p><a href="https://wordpress.stackexchange.com/questions/144343/wp-reset-postdata-or-wp-reset-query-after-a-custom-loop" target="_blank" rel="noopener">https://wordpress.stackexchange.com/questions/144343/wp-reset-postdata-or-wp-reset-query-after-a-custom-loop</a></p>
<h1 id="wp-cli-1"><a href="#wp-cli-1" class="headerlink" title="wp-cli"></a>wp-cli</h1><p><a href="https://wp-cli.org/zh-cn/" target="_blank" rel="noopener">https://wp-cli.org/zh-cn/</a></p>
<h1 id="從-bedrock-到正常的-wordpress"><a href="#從-bedrock-到正常的-wordpress" class="headerlink" title="從 bedrock 到正常的 wordpress"></a>從 bedrock 到正常的 wordpress</h1><p>//url.example/wp -&gt; //url.example<br>url.example/app/ -&gt; url.example/wp-content/</p>
<p>docker-compose run –rm wordpress-cli search-replace ‘//happypanda.subnet.vcn.oraclevcn.com/wp’ ‘//localhost:8000’</p>
<p>docker-compose run –rm wordpress-cli search-replace ‘happypanda.subnet.vcn.oraclevcn.com/app/‘ ‘localhost:8000/wp-content/‘</p>
<p>然後 sage 裡面的 wp-content/themes/happy-panda/resources/assets/config.json<br>“publicPath”: “/wp-content/themes/happy-panda”<br>要改 webpack 在編譯時路徑才會對</p>
<h1 id="poeidt"><a href="#poeidt" class="headerlink" title="poeidt"></a>poeidt</h1><p>語言翻譯教學<br><a href="https://www.youtube.com/watch?v=W5BkxT2dVo4" target="_blank" rel="noopener">https://www.youtube.com/watch?v=W5BkxT2dVo4</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2020/06/16/%E9%80%9A%E8%A8%8A%E8%88%87%E5%8D%94%E5%AE%9A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/16/%E9%80%9A%E8%A8%8A%E8%88%87%E5%8D%94%E5%AE%9A/" class="post-title-link" itemprop="url">通訊與協定</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-06-16 11:01:15" itemprop="dateCreated datePublished" datetime="2020-06-16T11:01:15+08:00">2020-06-16</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2021-12-22 15:35:23" itemprop="dateModified" datetime="2021-12-22T15:35:23+08:00">2021-12-22</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>主機通訊<br>http(rest api)<br>Remote Procedure Call, RPC (grpc)<br>Message Queuing,MQ(Pub/Sub)</p>
<p>即時通訊<br>websocket , webrtc , MQTT</p>
<p>採用通訊協定框架<br>長連接 短連接</p>
<h1 id="單線程-多線程"><a href="#單線程-多線程" class="headerlink" title="單線程 多線程"></a>單線程 多線程</h1><p>NPTL 所实现的线程库是 1:1 的从用户线程映射到内核线程，并且内核为了实现 POSIX 的线程标准也做了一些改动，比如对于信号的处理等。所以说 Linux 内核完全不区分进程和线程，甚至不知道线程的存在这种说法现在是不准确的。</p>
<p>序列化方式(bit json xml)</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://dkchange.github.io/2020/05/21/%E5%AD%97%E5%85%83%E7%B7%A8%E7%A2%BC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Stanley Ke">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蛋粒個人網誌">
    </span>

    
    
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/21/%E5%AD%97%E5%85%83%E7%B7%A8%E7%A2%BC/" class="post-title-link" itemprop="url">字元編碼</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2020-05-21 14:47:06" itemprop="dateCreated datePublished" datetime="2020-05-21T14:47:06+08:00">2020-05-21</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2023-03-18 10:29:13" itemprop="dateModified" datetime="2023-03-18T10:29:13+08:00">2023-03-18</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%BB%BB%E4%BD%95%E8%B7%AF%E7%B7%9A/" itemprop="url" rel="index"><span itemprop="name">任何路線</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><a href="http://vito-note.blogspot.com/2012/01/blog-post_86.html" target="_blank" rel="noopener">http://vito-note.blogspot.com/2012/01/blog-post_86.html</a><br><a href="http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html</a><br>平常在 coding 的我們，最常接觸的東西，就是打字啦，每一種編碼標準都是為了轉換 byte value 與 character，使用不同的編碼方式，同一个二进制数字可以被解释成不同的符號。<br>每一種特定的語言，都存在一種或數種的字集碼，每一種字集碼就是一個代碼頁 ( code page )。例如：big5 的 code page = 950</p>
<h1 id="Unicode"><a href="#Unicode" class="headerlink" title="Unicode"></a>Unicode</h1><p>但卻無法在同一個文件裏面同時支援多個語系。 Unicode 是為了解決傳統的字元編碼方案的侷限所產生的一項業界標準<br>它只规定了符号的二进制代码，却没有规定这个二进制代码应该如何存储。</p>
<h2 id="16-進制"><a href="#16-進制" class="headerlink" title="16 進制"></a>16 進制</h2><p>因為用二進制來對應所有的字實在太長<br>汉字严的 Unicode 是十六进制数 4E25<br>转换成二进制数足足有 15 位（100111000100101）<br>所以 unicode 採用 16 進制來做對應<br>Unicode 当然是一个很大的集合，现在的规模可以容纳 100 多万个符号。<br>你覺得字元要用多少 bit 才夠，如何有辦法對應所有的語言的字母<br>大概 2 的 21 次方就可以容納 1999999 個字，也就是 2bytes 到 3bytes 之間<br>\u4e2d\u6587 這是中文兩個字鎖對應的 unicode</p>
<h2 id="Unicode-衍生出的編碼方式"><a href="#Unicode-衍生出的編碼方式" class="headerlink" title="Unicode 衍生出的編碼方式"></a>Unicode 衍生出的編碼方式</h2><p><a href="https://www.branah.com/unicode-converter" target="_blank" rel="noopener">https://www.branah.com/unicode-converter</a></p>
<h3 id="UTF-8"><a href="#UTF-8" class="headerlink" title="UTF-8"></a>UTF-8</h3><p>UTF-8 是 Unicode 的实现方式之一，最大的一个特点，就是它是一种变长的编码方式。它可以使用 1~4 个字节表示一个符号<br>\xE4\xB8\xAD\xE6\x96\x87 這是中文兩個字鎖對應的 UTF-8</p>
<h3 id="UTF-16"><a href="#UTF-16" class="headerlink" title="UTF-16"></a>UTF-16</h3><p>UTF-16 是 Unicode 的实现方式之一，字符用两个字节或四个字节表示<br>\u{4e2d}\u{6587} 這是中文兩個字鎖對應的 UTF-16</p>
<h3 id="UTF-32"><a href="#UTF-32" class="headerlink" title="UTF-32"></a>UTF-32</h3><p>UTF-32 是 Unicode 的实现方式之一，字符用四个字节表示</p>
<p>那由以上來看，utf-8 要筆其他兩種方式都省空間<br>U+00004e2dU+00006587 這是中文兩個字鎖對應的 UTF-16</p>
<h1 id="資料庫字元編碼相關"><a href="#資料庫字元編碼相關" class="headerlink" title="資料庫字元編碼相關"></a>資料庫字元編碼相關</h1><h2 id="What’s-the-difference-between-utf8-general-ci-and-utf8-unicode-ci"><a href="#What’s-the-difference-between-utf8-general-ci-and-utf8-unicode-ci" class="headerlink" title="What’s the difference between utf8_general_ci and utf8_unicode_ci?"></a>What’s the difference between utf8_general_ci and utf8_unicode_ci?</h2><p>這個連結出現在 yii 官方 migration 的檔案裡面<br><a href="https://stackoverflow.com/questions/766809/whats-the-difference-between-utf8-general-ci-and-utf8-unicode-ci" target="_blank" rel="noopener">https://stackoverflow.com/questions/766809/whats-the-difference-between-utf8-general-ci-and-utf8-unicode-ci</a></p>
<h1 id="相關技巧"><a href="#相關技巧" class="headerlink" title="相關技巧"></a>相關技巧</h1><h2 id="16-進位的轉換"><a href="#16-進位的轉換" class="headerlink" title="16 進位的轉換"></a>16 進位的轉換</h2><p>假設你有一個 string str=”12345”<br>你想要加一個字元 enter 他的 16 進位編碼是 0A<br>“x31\x32\x33\x34\x35\x0A”貼在瀏覽器會變成</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"x312345</span></span><br><span class="line"><span class="string">"</span></span><br></pre></td></tr></table></figure>

<h2 id="查看"><a href="#查看" class="headerlink" title="查看"></a>查看</h2><p>$ od -xc “filename” | head</p>
<p>a ：利用預設的字元來輸出；<br>c ：使用 ASCII 字元來輸出<br>d[size] ：利用十進位(decimal)來輸出資料，每個整數佔用 size bytes ；<br>f[size] ：利用浮點數值(floating)來輸出資料，每個數佔用 size bytes ；<br>o[size] ：利用八進位(octal)來輸出資料，每個整數佔用 size bytes ；<br>x[size] ：利用十六進位(hexadecimal)來輸出資料，每個整數佔用 size bytes ；</p>
<h2 id="亂碼轉換"><a href="#亂碼轉換" class="headerlink" title="亂碼轉換"></a>亂碼轉換</h2><p>在UTF8還沒普及之前，大家都習慣有各自語言的編碼<br>例如big5和gbk<br>所以當你切換編碼時，編輯器在顯示時就會出現亂碼，此時你又按下了儲存鍵<br>這樣原本的gbk編碼的內容就會流失，要還原可能只能還原一部份了….</p>
<p><a href="https://www.modb.pro/db/106751" target="_blank" rel="noopener">GBK与UTF-8互转乱码详解</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一頁"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Stanley Ke</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  















  








  

  

</body>
</html>
